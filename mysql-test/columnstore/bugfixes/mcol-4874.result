DROP DATABASE IF EXISTS `mcol_4874`;
CREATE DATABASE `mcol_4874`;
USE `mcol_4874`;
CREATE USER IF NOT EXISTS'cejuser'@'localhost' IDENTIFIED BY 'Vagrant1|0000001';
GRANT ALL PRIVILEGES ON *.* TO 'cejuser'@'localhost';
FLUSH PRIVILEGES;
CREATE TABLE cs1 (a1 INT, b1 BIGINT, c1 INT)ENGINE=COLUMNSTORE;
CREATE TABLE i1 (a2 INT, b2 DECIMAL(37,0), c2 INT);
INSERT INTO cs1 VALUES (1, 11, 10), (1, 0, 11);
INSERT INTO i1 VALUES (1, 11, 100), (1, 0, 11), (1, 12, 101);
SELECT * FROM
(
SELECT a1 AS col1, COUNT(DISTINCT(IF((b1 <> 0), c1, NULL))) FROM cs1 group by col1
) as t1
JOIN
(
SELECT a2 AS col1, COUNT(DISTINCT(IF((b2 <> 0), c2, NULL))) FROM i1 GROUP BY col1
) as t2
USING (col1);
col1	COUNT(DISTINCT(IF((b1 <> 0), c1, NULL)))	COUNT(DISTINCT(IF((b2 <> 0), c2, NULL)))
1	1	2
DROP USER 'cejuser'@'localhost';
DROP DATABASE `mcol_4874`;
