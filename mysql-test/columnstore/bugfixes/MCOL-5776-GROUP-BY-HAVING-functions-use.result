DROP DATABASE IF EXISTS MCOL5776;
CREATE DATABASE MCOL5776;
USE MCOL5776;
CREATE TABLE t(x INTEGER, y INTEGER) ENGINE=COLUMNSTORE;
INSERT INTO t(x,y) VALUES (1,2), (2,3), (3,3);
SELECT COUNT(y) OVER (PARTITION BY y) FROM t GROUP BY x;
COUNT(y) OVER (PARTITION BY y)
1
2
2
SELECT COUNT(y) OVER (PARTITION BY LEFT(y, 10)) FROM t GROUP BY x;
COUNT(y) OVER (PARTITION BY LEFT(y, 10))
1
2
2
DROP TABLE t;
CREATE TABLE t(ci1 integer, ci2 integer) engine=columnstore;
INSERT INTO t(ci1, ci2) VALUES (NULL, 1), (NULL, 2), (1,3), (1,4), (2,5), (2,6), (3,7), (3,8);
SELECT ci1+ci2, ci1+ci2, SUM(ci2), AVG(ci2) FROM t GROUP BY ci1+ci2, ci1+ci2;
ci1+ci2	ci1+ci2	SUM(ci2)	AVG(ci2)
5	5	4	4.0000
10	10	7	7.0000
7	7	5	5.0000
8	8	6	6.0000
NULL	NULL	3	1.5000
11	11	8	8.0000
4	4	3	3.0000
SELECT CONCAT(ci1,ci2), CONCAT(ci1,ci2), SUM(ci2), AVG(ci2) FROM t GROUP BY ci1;
SELECT sum(ci1), abs(ci1) FROM t GROUP BY abs(ci1), abs(ci1);
sum(ci1)	abs(ci1)
6	3
2	1
NULL	NULL
4	2
SELECT sum(ci1), abs(ci1) FROM t GROUP BY abs(ci1);
sum(ci1)	abs(ci1)
6	3
2	1
NULL	NULL
4	2
DROP TABLE t;
CREATE TABLE t1(col1 INT, col2 TEXT)ENGINE=Columnstore;
INSERT INTO t1 VALUES(1, repeat('s',20)),(2, repeat('o',20)),(3, 'sss'),(4, 'ooo');
INSERT INTO t1 SELECT * FROM t1;
SELECT * FROM t1;
col1	col2
1	ssssssssssssssssssss
2	oooooooooooooooooooo
3	sss
4	ooo
1	ssssssssssssssssssss
2	oooooooooooooooooooo
3	sss
4	ooo
SELECT col2 FROM t1 GROUP BY col2 HAVING col2 LIKE '%o%' ORDER BY col2;
col2
ooo
oooooooooooooooooooo
SELECT col1 FROM t1 GROUP BY col1 HAVING col1 > 1 ORDER BY col1;
col1
2
3
4
col1	col2
2	oooooooooooooooooooo
4	ooo
SELECT col1, col2 FROM t1 GROUP BY col2 HAVING col2 LIKE '%o%' AND col1 > 1 ORDER BY col1;
col1	col2
2	oooooooooooooooooooo
4	ooo
SELECT col2, col1 FROM t1 GROUP BY col2 HAVING col1 > 1 AND col2 LIKE '%o%' ORDER BY col1;
col2	col1
oooooooooooooooooooo	2
ooo	4
SELECT col2, col1 FROM t1 GROUP BY col2 HAVING col2 LIKE '%o%' AND col1 > 1 ORDER BY col1;
col2	col1
oooooooooooooooooooo	2
ooo	4
SELECT col1, col2 FROM t1 GROUP BY col2 HAVING col2 LIKE '%o%' AND col1 > 1 ORDER BY col1;
col1	col2
2	oooooooooooooooooooo
4	ooo
SELECT col1, col2 FROM t1 GROUP BY col1 HAVING col1 > 1 AND col2 LIKE '%o%' ORDER BY col1;
col1	col2
2	oooooooooooooooooooo
4	ooo
SELECT col1, col2 FROM t1 GROUP BY col1 HAVING col2 LIKE '%o%' AND col1 > 1 ORDER BY col1;
col1	col2
2	oooooooooooooooooooo
4	ooo
SELECT col2, col1 FROM t1 GROUP BY col1 HAVING col1 > 1 AND col2 LIKE '%o%' ORDER BY col1;
col2	col1
oooooooooooooooooooo	2
ooo	4
SELECT col2, col1 FROM t1 GROUP BY col1 HAVING col2 LIKE '%o%' AND col1 > 1 ORDER BY col1;
col2	col1
oooooooooooooooooooo	2
ooo	4
SELECT col1, col2 FROM t1 GROUP BY col1 HAVING col2 LIKE '%o%' AND col1 > 1 ORDER BY col1;
col1	col2
2	oooooooooooooooooooo
4	ooo
SELECT col2, col1 FROM t1 GROUP BY col1 HAVING col1 > 1 AND col2 = 'ooo' ORDER BY col1;
col2	col1
ooo	4
SELECT col2, col1 FROM t1 GROUP BY col1 HAVING col2 = 'ooo' AND col1 > 1 ORDER BY col1;
col2	col1
ooo	4
SELECT col2, col1 FROM t1 GROUP BY col1 HAVING col1 > 1 AND col2 >= 'ooo' ORDER BY col1;
col2	col1
oooooooooooooooooooo	2
sss	3
ooo	4
SELECT col2, col1 FROM t1 GROUP BY col1 HAVING col2 >= 'ooo' AND col1 > 1 ORDER BY col1;
col2	col1
oooooooooooooooooooo	2
sss	3
ooo	4
SELECT col2, col1 FROM t1 GROUP BY col1 HAVING col1 > 1 AND col2 < 'ooo' ORDER BY col1;
col2	col1
SELECT col2, col1 FROM t1 GROUP BY col1 HAVING col2 < 'ooo' AND col1 > 1 ORDER BY col1;
col2	col1
SELECT col2, col1 FROM t1 GROUP BY col1 HAVING col1 > 1 AND 'ooo' < col2 ORDER BY col1;
col2	col1
oooooooooooooooooooo	2
sss	3
SELECT col2, col1 FROM t1 GROUP BY col1 HAVING 'ooo' < col2 AND col1 > 1 ORDER BY col1;
col2	col1
oooooooooooooooooooo	2
sss	3
SELECT col1, col2, SUM(LENGTH(col2)) FROM t1 GROUP BY col1 HAVING SUM(LENGTH(col2)) > 10 ORDER BY col1;
col1	col2	SUM(LENGTH(col2))
1	ssssssssssssssssssss	40
2	oooooooooooooooooooo	40
SELECT col1, col2, SUM(LENGTH(col2)) a FROM t1 GROUP BY col1 HAVING a > 1 AND col2 LIKE '%o%' ORDER BY col1;
col1	col2	a
2	oooooooooooooooooooo	40
4	ooo	6
DROP DATABASE MCOL5776;
