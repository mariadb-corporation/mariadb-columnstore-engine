DROP DATABASE IF EXISTS mcs165_db;
CREATE DATABASE mcs165_db;
USE mcs165_db;
CREATE TABLE t1 (a CHAR(1), b INT)ENGINE=Columnstore;
INSERT INTO t1 VALUES ('', NULL),('a', 12),('a', 13),('b', 14),('c', 15),('d', 16),('d', 17),('b', 18),('a', 19);
SELECT a, b, SUM(b) OVER(ORDER BY b RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) sum FROM t1;
a	b	sum
NULL	NULL	NULL
a	12	12
a	13	25
b	14	39
c	15	54
d	16	70
d	17	87
b	18	105
a	19	124
SELECT a, b, SUM(b) OVER(ORDER BY b RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) sum FROM t1;
a	b	sum
NULL	NULL	124
a	12	124
a	13	112
b	14	99
c	15	85
d	16	70
d	17	54
b	18	37
a	19	19
SELECT a, b, SUM(b) OVER(ORDER BY b ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) sum FROM t1;
a	b	sum
NULL	NULL	NULL
a	12	12
a	13	25
b	14	27
c	15	29
d	16	31
d	17	33
b	18	35
a	19	37
SELECT a, b, SUM(b) OVER(ORDER BY b ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) sum FROM t1;
a	b	sum
NULL	NULL	12
a	12	25
a	13	39
b	14	42
c	15	45
d	16	48
d	17	51
b	18	54
a	19	37
SELECT a, b, SUM(b) OVER(ORDER BY b ROWS BETWEEN 1 PRECEDING AND UNBOUNDED FOLLOWING) sum FROM t1;
a	b	sum
NULL	NULL	124
a	12	124
a	13	124
b	14	112
c	15	99
d	16	85
d	17	70
b	18	54
a	19	37
SELECT a, b, SUM(b) OVER(ORDER BY b DESC RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) sum FROM t1;
a	b	sum
a	19	19
b	18	37
d	17	54
d	16	70
c	15	85
b	14	99
a	13	112
a	12	124
NULL	NULL	124
SELECT a, b, SUM(b) OVER(ORDER BY b DESC RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) sum FROM t1;
a	b	sum
a	19	124
b	18	105
d	17	87
d	16	70
c	15	54
b	14	39
a	13	25
a	12	12
NULL	NULL	NULL
SELECT a, b, SUM(b) OVER(ORDER BY b DESC ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) sum FROM t1;
a	b	sum
a	19	19
b	18	37
d	17	35
d	16	33
c	15	31
b	14	29
a	13	27
a	12	25
NULL	NULL	12
SELECT a, b, SUM(b) OVER(ORDER BY b DESC ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) sum FROM t1;
a	b	sum
a	19	37
b	18	54
d	17	51
d	16	48
c	15	45
b	14	42
a	13	39
a	12	25
NULL	NULL	12
SELECT a, b, SUM(b) OVER(ORDER BY b DESC ROWS BETWEEN 1 PRECEDING AND UNBOUNDED FOLLOWING) sum FROM t1;
a	b	sum
a	19	124
b	18	124
d	17	105
d	16	87
c	15	70
b	14	54
a	13	39
a	12	25
NULL	NULL	12
SELECT a, b, SUM(b) OVER(PARTITION BY a ORDER BY b RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) sum FROM t1;
a	b	sum
NULL	NULL	NULL
a	12	12
a	13	25
a	19	44
b	14	14
b	18	32
c	15	15
d	16	16
d	17	33
SELECT a, b, SUM(b) OVER(PARTITION BY b ORDER BY b RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) sum FROM t1;
a	b	sum
NULL	NULL	NULL
a	12	12
a	13	13
b	14	14
c	15	15
d	16	16
d	17	17
b	18	18
a	19	19
SELECT a, b, SUM(b) OVER(PARTITION BY a ORDER BY b RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) sum FROM t1;
a	b	sum
NULL	NULL	NULL
a	12	44
a	13	32
a	19	19
b	14	32
b	18	18
c	15	15
d	16	33
d	17	17
SELECT a, b, SUM(b) OVER(PARTITION BY b ORDER BY b RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) sum FROM t1;
a	b	sum
NULL	NULL	NULL
a	12	12
a	13	13
b	14	14
c	15	15
d	16	16
d	17	17
b	18	18
a	19	19
SELECT a, b, SUM(b) OVER(PARTITION BY a ORDER BY b ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) sum FROM t1;
a	b	sum
NULL	NULL	NULL
a	12	12
a	13	25
a	19	32
b	14	14
b	18	32
c	15	15
d	16	16
d	17	33
SELECT a, b, SUM(b) OVER(PARTITION BY b ORDER BY b ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) sum FROM t1;
a	b	sum
NULL	NULL	NULL
a	12	12
a	13	13
b	14	14
c	15	15
d	16	16
d	17	17
b	18	18
a	19	19
SELECT a, b, SUM(b) OVER(PARTITION BY a ORDER BY b ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) sum FROM t1;
a	b	sum
NULL	NULL	NULL
a	12	25
a	13	44
a	19	32
b	14	32
b	18	32
c	15	15
d	16	33
d	17	33
SELECT a, b, SUM(b) OVER(PARTITION BY b ORDER BY b ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) sum FROM t1;
a	b	sum
NULL	NULL	NULL
a	12	12
a	13	13
b	14	14
c	15	15
d	16	16
d	17	17
b	18	18
a	19	19
SELECT a, b, SUM(b) OVER(PARTITION BY a ORDER BY b ROWS BETWEEN 1 PRECEDING AND UNBOUNDED FOLLOWING) sum FROM t1;
a	b	sum
NULL	NULL	NULL
a	12	44
a	13	44
a	19	32
b	14	32
b	18	32
c	15	15
d	16	33
d	17	33
SELECT a, b, SUM(b) OVER(PARTITION BY b ORDER BY b ROWS BETWEEN 1 PRECEDING AND UNBOUNDED FOLLOWING) sum FROM t1;
a	b	sum
NULL	NULL	NULL
a	12	12
a	13	13
b	14	14
c	15	15
d	16	16
d	17	17
b	18	18
a	19	19
SELECT a, b, SUM(b) OVER(PARTITION BY b RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) sum FROM t1;
ERROR HY000: RANGE-type frame requires ORDER BY clause with single sort key
SELECT a, b, SUM(b) OVER(ORDER BY a RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) sum FROM t1;
ERROR HY000: Numeric datatype is required for RANGE-type frame
DROP DATABASE mcs165_db;
