DROP DATABASE IF EXISTS mcs139_db;
CREATE DATABASE mcs139_db;
USE mcs139_db;
CREATE TABLE t1 (a CHAR(1), b INT)ENGINE=Columnstore;
INSERT INTO t1 VALUES ('', NULL),('a', 123),('a', 1),('b', 123),('c', 1861),('c', 1991),('d', 10701),('d', 1071),('a', 92);
SELECT a, b, MIN(b) OVER(ORDER BY a) min FROM t1;
a	b	min
NULL	NULL	NULL
a	92	1
a	1	1
a	123	1
b	123	1
c	1991	1
c	1861	1
d	1071	1
d	10701	1
SELECT a, b, MIN(b) OVER(ORDER BY b DESC) min FROM t1;
a	b	min
d	10701	10701
c	1991	1991
c	1861	1861
d	1071	1071
a	123	123
b	123	123
a	92	92
a	1	1
NULL	NULL	1
SELECT a, b, MIN(b) OVER w min FROM t1 WINDOW w AS (ORDER BY a DESC);
a	b	min
d	10701	1071
d	1071	1071
c	1861	1071
c	1991	1071
b	123	123
a	92	1
a	123	1
a	1	1
NULL	NULL	1
SELECT a, b, MIN(b) OVER w min FROM t1 WINDOW w AS (ORDER BY b);
a	b	min
NULL	NULL	NULL
a	1	1
a	92	1
b	123	1
a	123	1
d	1071	1
c	1861	1
c	1991	1
d	10701	1
SELECT a, b, MIN(b) OVER(PARTITION BY a) min FROM t1;
a	b	min
NULL	NULL	NULL
a	92	1
a	1	1
a	123	1
b	123	123
c	1991	1861
c	1861	1861
d	1071	1071
d	10701	1071
SELECT a, b, MIN(b) OVER(PARTITION BY b) min FROM t1;
a	b	min
NULL	NULL	NULL
a	1	1
a	92	92
b	123	123
a	123	123
d	1071	1071
c	1861	1861
c	1991	1991
d	10701	10701
SELECT a, b, MIN(b) OVER(PARTITION BY a ORDER BY a DESC) min FROM t1;
a	b	min
NULL	NULL	NULL
a	92	1
a	1	1
a	123	1
b	123	123
c	1991	1861
c	1861	1861
d	1071	1071
d	10701	1071
SELECT a, b, MIN(b) OVER(PARTITION BY a ORDER BY b DESC) min FROM t1;
a	b	min
NULL	NULL	NULL
a	123	123
a	92	92
a	1	1
b	123	123
c	1991	1991
c	1861	1861
d	10701	10701
d	1071	1071
SELECT a, b, MIN(b) OVER(PARTITION BY a ORDER BY b ASC) min FROM t1;
a	b	min
NULL	NULL	NULL
a	1	1
a	92	1
a	123	1
b	123	123
c	1861	1861
c	1991	1861
d	1071	1071
d	10701	1071
SELECT a, b, MIN(b) OVER(PARTITION BY b ORDER BY a DESC) min FROM t1;
a	b	min
NULL	NULL	NULL
a	1	1
a	92	92
b	123	123
a	123	123
d	1071	1071
c	1861	1861
c	1991	1991
d	10701	10701
SELECT a, b, MIN(b) OVER(PARTITION BY b ORDER BY b DESC) min FROM t1;
a	b	min
NULL	NULL	NULL
a	1	1
a	92	92
b	123	123
a	123	123
d	1071	1071
c	1861	1861
c	1991	1991
d	10701	10701
DROP DATABASE mcs139_db;
