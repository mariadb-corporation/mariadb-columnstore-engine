DROP DATABASE IF EXISTS mcs125_db;
CREATE DATABASE mcs125_db;
USE mcs125_db;
CREATE TABLE t1 (a CHAR(1), b INT)ENGINE=Columnstore;
INSERT INTO t1 VALUES ('', NULL),('a', 123),('a', 1),('b', 123),('c', 1861),('c', 1991),('d', 10701),('d', 1071),('a', 92);
SELECT a, b, FIRST_VALUE(b) OVER(ORDER BY a DESC) fv FROM t1;
a	b	fv
d	10701	10701
d	1071	10701
c	1861	10701
c	1991	10701
b	123	10701
a	92	10701
a	123	10701
a	1	10701
NULL	NULL	10701
SELECT a, b, FIRST_VALUE(a) OVER(ORDER BY a DESC) fv FROM t1;
a	b	fv
d	10701	d
d	1071	d
c	1861	d
c	1991	d
b	123	d
a	92	d
a	123	d
a	1	d
NULL	NULL	d
SELECT a, b, FIRST_VALUE(b) OVER(ORDER BY b) fv FROM t1;
a	b	fv
NULL	NULL	NULL
a	1	NULL
a	92	NULL
b	123	NULL
a	123	NULL
d	1071	NULL
c	1861	NULL
c	1991	NULL
d	10701	NULL
SELECT a, b, FIRST_VALUE(a) OVER(ORDER BY b) fv FROM t1;
a	b	fv
NULL	NULL	NULL
a	1	NULL
a	92	NULL
b	123	NULL
a	123	NULL
d	1071	NULL
c	1861	NULL
c	1991	NULL
d	10701	NULL
SELECT a, b, FIRST_VALUE(b) OVER w fv FROM t1 WINDOW w AS (PARTITION BY a DESC);
a	b	fv
NULL	NULL	NULL
a	92	92
a	1	92
a	123	92
b	123	123
c	1991	1991
c	1861	1991
d	1071	1071
d	10701	1071
SELECT a, b, FIRST_VALUE(a) OVER w fv FROM t1 WINDOW w AS (PARTITION BY b);
a	b	fv
NULL	NULL	NULL
a	1	a
a	92	a
b	123	b
a	123	b
d	1071	d
c	1861	c
c	1991	c
d	10701	d
SELECT a, b, FIRST_VALUE(b) OVER(PARTITION BY b) fv FROM t1;
a	b	fv
NULL	NULL	NULL
a	1	1
a	92	92
b	123	123
a	123	123
d	1071	1071
c	1861	1861
c	1991	1991
d	10701	10701
SELECT a, b, FIRST_VALUE(a) OVER(PARTITION BY a) fv FROM t1;
a	b	fv
NULL	NULL	NULL
a	92	a
a	1	a
a	123	a
b	123	b
c	1991	c
c	1861	c
d	1071	d
d	10701	d
SELECT a, b, FIRST_VALUE(a) OVER(PARTITION BY a ORDER BY a DESC) fv FROM t1;
a	b	fv
NULL	NULL	NULL
a	92	a
a	1	a
a	123	a
b	123	b
c	1991	c
c	1861	c
d	1071	d
d	10701	d
SELECT a, b, FIRST_VALUE(b) OVER(PARTITION BY a ORDER BY b DESC) fv FROM t1;
a	b	fv
NULL	NULL	NULL
a	123	123
a	92	123
a	1	123
b	123	123
c	1991	1991
c	1861	1991
d	10701	10701
d	1071	10701
SELECT a, b, FIRST_VALUE(a) OVER(PARTITION BY a ORDER BY b ASC) fv FROM t1;
a	b	fv
NULL	NULL	NULL
a	1	a
a	92	a
a	123	a
b	123	b
c	1861	c
c	1991	c
d	1071	d
d	10701	d
SELECT a, b, FIRST_VALUE(a) OVER(PARTITION BY b ORDER BY a DESC) fv FROM t1;
a	b	fv
NULL	NULL	NULL
a	1	a
a	92	a
b	123	b
a	123	b
d	1071	d
c	1861	c
c	1991	c
d	10701	d
SELECT a, b, FIRST_VALUE(b) OVER(PARTITION BY b ORDER BY b DESC) fv FROM t1;
a	b	fv
NULL	NULL	NULL
a	1	1
a	92	92
b	123	123
a	123	123
d	1071	1071
c	1861	1861
c	1991	1991
d	10701	10701
DROP DATABASE mcs125_db;
