DROP DATABASE IF EXISTS mcs132_db;
CREATE DATABASE mcs132_db;
USE mcs132_db;
CREATE TABLE t1 (a CHAR(1), b INT)ENGINE=Columnstore;
INSERT INTO t1 VALUES ('', NULL),('a', 12),('a', 13),('b', 14),('b', 15),('b', 16),('b', 17),('b', 18),('a', 19);
SELECT a, b, PERCENTILE_CONT(1) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY a DESC) pc FROM t1;
a	b	pc
NULL	NULL	NULL
a	12	19.0000000000
a	13	19.0000000000
a	19	19.0000000000
b	14	18.0000000000
b	15	18.0000000000
b	16	18.0000000000
b	17	18.0000000000
b	18	18.0000000000
SELECT a, b, PERCENTILE_CONT(0) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY a DESC) pc FROM t1;
a	b	pc
NULL	NULL	NULL
a	12	12.0000000000
a	13	12.0000000000
a	19	12.0000000000
b	14	14.0000000000
b	15	14.0000000000
b	16	14.0000000000
b	17	14.0000000000
b	18	14.0000000000
SELECT a, b, PERCENTILE_CONT(0.1) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY a DESC) pc FROM t1;
a	b	pc
NULL	NULL	NULL
a	12	12.2000000000
a	13	12.2000000000
a	19	12.2000000000
b	14	14.4000000000
b	15	14.4000000000
b	16	14.4000000000
b	17	14.4000000000
b	18	14.4000000000
SELECT a, b, PERCENTILE_CONT(0.5) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY a DESC) pc FROM t1;
a	b	pc
NULL	NULL	NULL
a	12	13.0000000000
a	13	13.0000000000
a	19	13.0000000000
b	14	16.0000000000
b	15	16.0000000000
b	16	16.0000000000
b	17	16.0000000000
b	18	16.0000000000
SELECT a, b, PERCENTILE_CONT(0.6) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY a DESC) pc FROM t1;
a	b	pc
NULL	NULL	NULL
a	12	14.2000000000
a	13	14.2000000000
a	19	14.2000000000
b	14	16.4000000000
b	15	16.4000000000
b	16	16.4000000000
b	17	16.4000000000
b	18	16.4000000000
SELECT a, b, PERCENTILE_CONT(0.61) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY a DESC) pc FROM t1;
a	b	pc
NULL	NULL	NULL
a	12	14.3200000000
a	13	14.3200000000
a	19	14.3200000000
b	14	16.4400000000
b	15	16.4400000000
b	16	16.4400000000
b	17	16.4400000000
b	18	16.4400000000
SELECT a, b, PERCENTILE_CONT(0.65) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY a DESC) pc FROM t1;
a	b	pc
NULL	NULL	NULL
a	12	14.8000000000
a	13	14.8000000000
a	19	14.8000000000
b	14	16.6000000000
b	15	16.6000000000
b	16	16.6000000000
b	17	16.6000000000
b	18	16.6000000000
SELECT a, b, PERCENTILE_CONT(0.69) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY a DESC) pc FROM t1;
a	b	pc
NULL	NULL	NULL
a	12	15.2800000000
a	13	15.2800000000
a	19	15.2800000000
b	14	16.7600000000
b	15	16.7600000000
b	16	16.7600000000
b	17	16.7600000000
b	18	16.7600000000
SELECT a, b, PERCENTILE_CONT(0.7) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY a DESC) pc FROM t1;
a	b	pc
NULL	NULL	NULL
a	12	15.4000000000
a	13	15.4000000000
a	19	15.4000000000
b	14	16.8000000000
b	15	16.8000000000
b	16	16.8000000000
b	17	16.8000000000
b	18	16.8000000000
SELECT a, b, PERCENTILE_CONT(0) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY b DESC) pc FROM t1;
a	b	pc
NULL	NULL	NULL
a	12	12.0000000000
a	13	13.0000000000
b	14	14.0000000000
b	15	15.0000000000
b	16	16.0000000000
b	17	17.0000000000
b	18	18.0000000000
a	19	19.0000000000
SELECT a, b, PERCENTILE_CONT(1) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY b DESC) pc FROM t1;
a	b	pc
NULL	NULL	NULL
a	12	12.0000000000
a	13	13.0000000000
b	14	14.0000000000
b	15	15.0000000000
b	16	16.0000000000
b	17	17.0000000000
b	18	18.0000000000
a	19	19.0000000000
SELECT a, b, PERCENTILE_CONT(0.1) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY b DESC) pc FROM t1;
a	b	pc
NULL	NULL	NULL
a	12	12.0000000000
a	13	13.0000000000
b	14	14.0000000000
b	15	15.0000000000
b	16	16.0000000000
b	17	17.0000000000
b	18	18.0000000000
a	19	19.0000000000
SELECT a, b, PERCENTILE_CONT(0.5) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY b DESC) pc FROM t1;
a	b	pc
NULL	NULL	NULL
a	12	12.0000000000
a	13	13.0000000000
b	14	14.0000000000
b	15	15.0000000000
b	16	16.0000000000
b	17	17.0000000000
b	18	18.0000000000
a	19	19.0000000000
SELECT a, b, PERCENTILE_CONT(0.6) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY b DESC) pc FROM t1;
a	b	pc
NULL	NULL	NULL
a	12	12.0000000000
a	13	13.0000000000
b	14	14.0000000000
b	15	15.0000000000
b	16	16.0000000000
b	17	17.0000000000
b	18	18.0000000000
a	19	19.0000000000
SELECT a, b, PERCENTILE_CONT(0.61) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY b DESC) pc FROM t1;
a	b	pc
NULL	NULL	NULL
a	12	12.0000000000
a	13	13.0000000000
b	14	14.0000000000
b	15	15.0000000000
b	16	16.0000000000
b	17	17.0000000000
b	18	18.0000000000
a	19	19.0000000000
SELECT a, b, PERCENTILE_CONT(0.65) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY b DESC) pc FROM t1;
a	b	pc
NULL	NULL	NULL
a	12	12.0000000000
a	13	13.0000000000
b	14	14.0000000000
b	15	15.0000000000
b	16	16.0000000000
b	17	17.0000000000
b	18	18.0000000000
a	19	19.0000000000
SELECT a, b, PERCENTILE_CONT(0.69) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY b DESC) pc FROM t1;
a	b	pc
NULL	NULL	NULL
a	12	12.0000000000
a	13	13.0000000000
b	14	14.0000000000
b	15	15.0000000000
b	16	16.0000000000
b	17	17.0000000000
b	18	18.0000000000
a	19	19.0000000000
SELECT a, b, PERCENTILE_CONT(0.7) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY b DESC) pc FROM t1;
a	b	pc
NULL	NULL	NULL
a	12	12.0000000000
a	13	13.0000000000
b	14	14.0000000000
b	15	15.0000000000
b	16	16.0000000000
b	17	17.0000000000
b	18	18.0000000000
a	19	19.0000000000
SELECT a, b, PERCENTILE_CONT(0) WITHIN GROUP(ORDER BY b DESC) OVER(PARTITION BY b) pc FROM t1;
a	b	pc
NULL	NULL	NULL
a	12	12.0000000000
a	13	13.0000000000
b	14	14.0000000000
b	15	15.0000000000
b	16	16.0000000000
b	17	17.0000000000
b	18	18.0000000000
a	19	19.0000000000
SELECT a, b, PERCENTILE_CONT(0) WITHIN GROUP(ORDER BY b DESC) OVER(PARTITION BY a) pc FROM t1;
a	b	pc
NULL	NULL	NULL
a	19	19.0000000000
a	13	19.0000000000
a	12	19.0000000000
b	18	18.0000000000
b	17	18.0000000000
b	16	18.0000000000
b	15	18.0000000000
b	14	18.0000000000
SELECT a, b, PERCENTILE_CONT(-0.9) WITHIN GROUP(ORDER BY b DESC) OVER(PARTITION BY b DESC) pc FROM t1;
ERROR HY000: Internal error: MCS-9027: Argument '-0.9' is out of range.
SELECT a, b, PERCENTILE_CONT(-1) WITHIN GROUP(ORDER BY b DESC) OVER(PARTITION BY b DESC) pc FROM t1;
ERROR HY000: Internal error: MCS-9027: Argument '-1' is out of range.
SELECT a, b, PERCENTILE_CONT(1.1) WITHIN GROUP(ORDER BY b DESC) OVER(PARTITION BY b DESC) pc FROM t1;
ERROR HY000: Internal error: MCS-9027: Argument '1.1' is out of range.
SELECT a, b, PERCENTILE_CONT(0) WITHIN GROUP(ORDER BY a DESC) OVER(PARTITION BY a DESC) pc FROM t1;
ERROR HY000: Numeric datatype is required for percentile_cont function
DROP DATABASE mcs132_db;
