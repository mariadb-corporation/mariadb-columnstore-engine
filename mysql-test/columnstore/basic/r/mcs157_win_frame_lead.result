DROP DATABASE IF EXISTS mcs157_db;
CREATE DATABASE mcs157_db;
USE mcs157_db;
CREATE TABLE t1 (a CHAR(1), b INT)ENGINE=Columnstore;
INSERT INTO t1 VALUES ('', NULL),('a', 12),('a', 13),('b', 14),('c', 15),('d', 16),('d', 17),('b', 18),('a', 19);
SELECT a, b, LEAD(b) OVER(ORDER BY b RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) lead_value FROM t1;
a	b	lead_value
NULL	NULL	12
a	12	13
a	13	14
b	14	15
c	15	16
d	16	17
d	17	18
b	18	19
a	19	NULL
SELECT a, b, LEAD(b) OVER(ORDER BY b RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) lead_value FROM t1;
a	b	lead_value
NULL	NULL	12
a	12	13
a	13	14
b	14	15
c	15	16
d	16	17
d	17	18
b	18	19
a	19	NULL
SELECT a, b, LEAD(b, 2) OVER(ORDER BY b ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) lead_value FROM t1;
a	b	lead_value
NULL	NULL	NULL
a	12	NULL
a	13	NULL
b	14	NULL
c	15	NULL
d	16	NULL
d	17	NULL
b	18	NULL
a	19	NULL
SELECT a, b, LEAD(b, 0) OVER(ORDER BY b ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) lead_value FROM t1;
a	b	lead_value
NULL	NULL	NULL
a	12	12
a	13	13
b	14	14
c	15	15
d	16	16
d	17	17
b	18	18
a	19	19
SELECT a, b, LEAD(b, -1) OVER(ORDER BY b ROWS BETWEEN 1 PRECEDING AND UNBOUNDED FOLLOWING) lead_value FROM t1;
a	b	lead_value
NULL	NULL	NULL
a	12	NULL
a	13	NULL
b	14	NULL
c	15	NULL
d	16	NULL
d	17	NULL
b	18	NULL
a	19	18
SELECT a, b, LEAD(a) OVER(ORDER BY b DESC RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) lead_value FROM t1;
a	b	lead_value
a	19	b
b	18	d
d	17	d
d	16	c
c	15	b
b	14	a
a	13	a
a	12	NULL
NULL	NULL	NULL
SELECT a, b, LEAD(a) OVER(ORDER BY b DESC RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) lead_value FROM t1;
a	b	lead_value
a	19	b
b	18	d
d	17	d
d	16	c
c	15	b
b	14	a
a	13	a
a	12	NULL
NULL	NULL	NULL
SELECT a, b, LEAD(a) OVER(ORDER BY b DESC ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) lead_value FROM t1;
a	b	lead_value
a	19	b
b	18	d
d	17	d
d	16	c
c	15	b
b	14	a
a	13	a
a	12	NULL
NULL	NULL	NULL
SELECT a, b, LEAD(a) OVER(ORDER BY b DESC ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) lead_value FROM t1;
a	b	lead_value
a	19	b
b	18	d
d	17	d
d	16	c
c	15	b
b	14	a
a	13	a
a	12	NULL
NULL	NULL	NULL
SELECT a, b, LEAD(a) OVER(ORDER BY b DESC ROWS BETWEEN 1 PRECEDING AND UNBOUNDED FOLLOWING) lead_value FROM t1;
a	b	lead_value
a	19	b
b	18	d
d	17	d
d	16	c
c	15	b
b	14	a
a	13	a
a	12	NULL
NULL	NULL	NULL
SELECT a, b, LEAD(b) OVER(PARTITION BY a ORDER BY b RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) lead_value FROM t1;
a	b	lead_value
NULL	NULL	NULL
a	12	13
a	13	19
a	19	NULL
b	14	18
b	18	NULL
c	15	NULL
d	16	17
d	17	NULL
SELECT a, b, LEAD(b) OVER(PARTITION BY b ORDER BY b RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) lead_value FROM t1;
a	b	lead_value
NULL	NULL	NULL
a	12	NULL
a	13	NULL
b	14	NULL
c	15	NULL
d	16	NULL
d	17	NULL
b	18	NULL
a	19	NULL
SELECT a, b, LEAD(b) OVER(PARTITION BY a ORDER BY b RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) lead_value FROM t1;
a	b	lead_value
NULL	NULL	NULL
a	12	13
a	13	19
a	19	NULL
b	14	18
b	18	NULL
c	15	NULL
d	16	17
d	17	NULL
SELECT a, b, LEAD(b) OVER(PARTITION BY b ORDER BY b RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) lead_value FROM t1;
a	b	lead_value
NULL	NULL	NULL
a	12	NULL
a	13	NULL
b	14	NULL
c	15	NULL
d	16	NULL
d	17	NULL
b	18	NULL
a	19	NULL
SELECT a, b, LEAD(b) OVER(PARTITION BY a ORDER BY b ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) lead_value FROM t1;
a	b	lead_value
NULL	NULL	NULL
a	12	13
a	13	19
a	19	NULL
b	14	18
b	18	NULL
c	15	NULL
d	16	17
d	17	NULL
SELECT a, b, LEAD(b) OVER(PARTITION BY b ORDER BY b ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) lead_value FROM t1;
a	b	lead_value
NULL	NULL	NULL
a	12	NULL
a	13	NULL
b	14	NULL
c	15	NULL
d	16	NULL
d	17	NULL
b	18	NULL
a	19	NULL
SELECT a, b, LEAD(b) OVER(PARTITION BY a ORDER BY b ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) lead_value FROM t1;
a	b	lead_value
NULL	NULL	NULL
a	12	13
a	13	19
a	19	NULL
b	14	18
b	18	NULL
c	15	NULL
d	16	17
d	17	NULL
SELECT a, b, LEAD(b) OVER(PARTITION BY b ORDER BY b ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) lead_value FROM t1;
a	b	lead_value
NULL	NULL	NULL
a	12	NULL
a	13	NULL
b	14	NULL
c	15	NULL
d	16	NULL
d	17	NULL
b	18	NULL
a	19	NULL
SELECT a, b, LEAD(b) OVER(PARTITION BY a ORDER BY b ROWS BETWEEN 1 PRECEDING AND UNBOUNDED FOLLOWING) lead_value FROM t1;
a	b	lead_value
NULL	NULL	NULL
a	12	13
a	13	19
a	19	NULL
b	14	18
b	18	NULL
c	15	NULL
d	16	17
d	17	NULL
SELECT a, b, LEAD(b) OVER(PARTITION BY b ORDER BY b ROWS BETWEEN 1 PRECEDING AND UNBOUNDED FOLLOWING) lead_value FROM t1;
a	b	lead_value
NULL	NULL	NULL
a	12	NULL
a	13	NULL
b	14	NULL
c	15	NULL
d	16	NULL
d	17	NULL
b	18	NULL
a	19	NULL
SELECT a, b, LEAD(b) OVER(PARTITION BY b RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) lead_value FROM t1;
ERROR HY000: No order list in window specification for 'lead'
SELECT a, b, LEAD(b) OVER(ORDER BY a RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) lead_value FROM t1;
ERROR HY000: Numeric datatype is required for RANGE-type frame
DROP DATABASE mcs157_db;
