DROP DATABASE IF EXISTS mcs133_db;
CREATE DATABASE mcs133_db;
USE mcs133_db;
CREATE TABLE t1 (a CHAR(1), b INT)ENGINE=Columnstore;
INSERT INTO t1 VALUES ('', NULL),('a', 12),('a', 13),('b', 14),('b', 15),('b', 16),('b', 17),('b', 18),('a', 19);
SELECT a, b, PERCENTILE_DISC(1) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY a DESC) pd FROM t1;
a	b	pd
NULL	NULL	2147483647
a	12	19
a	13	19
a	19	19
b	14	18
b	15	18
b	16	18
b	17	18
b	18	18
SELECT a, b, PERCENTILE_DISC(0) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY a DESC) pd FROM t1;
a	b	pd
NULL	NULL	2147483647
a	12	12
a	13	12
a	19	12
b	14	14
b	15	14
b	16	14
b	17	14
b	18	14
SELECT a, b, PERCENTILE_DISC(0.1) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY a DESC) pd FROM t1;
a	b	pd
NULL	NULL	2147483647
a	12	12
a	13	12
a	19	12
b	14	14
b	15	14
b	16	14
b	17	14
b	18	14
SELECT a, b, PERCENTILE_DISC(0.5) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY a DESC) pd FROM t1;
a	b	pd
NULL	NULL	2147483647
a	12	13
a	13	13
a	19	13
b	14	16
b	15	16
b	16	16
b	17	16
b	18	16
SELECT a, b, PERCENTILE_DISC(0.6) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY a DESC) pd FROM t1;
a	b	pd
NULL	NULL	2147483647
a	12	13
a	13	13
a	19	13
b	14	16
b	15	16
b	16	16
b	17	16
b	18	16
SELECT a, b, PERCENTILE_DISC(0.61) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY a DESC) pd FROM t1;
a	b	pd
NULL	NULL	2147483647
a	12	13
a	13	13
a	19	13
b	14	17
b	15	17
b	16	17
b	17	17
b	18	17
SELECT a, b, PERCENTILE_DISC(0.65) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY a DESC) pd FROM t1;
a	b	pd
NULL	NULL	2147483647
a	12	13
a	13	13
a	19	13
b	14	17
b	15	17
b	16	17
b	17	17
b	18	17
SELECT a, b, PERCENTILE_DISC(0.69) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY a DESC) pd FROM t1;
a	b	pd
NULL	NULL	2147483647
a	12	19
a	13	19
a	19	19
b	14	17
b	15	17
b	16	17
b	17	17
b	18	17
SELECT a, b, PERCENTILE_DISC(0.7) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY a DESC) pd FROM t1;
a	b	pd
NULL	NULL	2147483647
a	12	19
a	13	19
a	19	19
b	14	17
b	15	17
b	16	17
b	17	17
b	18	17
SELECT a, b, PERCENTILE_DISC(0) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY b DESC) pd FROM t1;
a	b	pd
NULL	NULL	2147483647
a	12	12
a	13	13
b	14	14
b	15	15
b	16	16
b	17	17
b	18	18
a	19	19
SELECT a, b, PERCENTILE_DISC(1) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY b DESC) pd FROM t1;
a	b	pd
NULL	NULL	2147483647
a	12	12
a	13	13
b	14	14
b	15	15
b	16	16
b	17	17
b	18	18
a	19	19
SELECT a, b, PERCENTILE_DISC(0.1) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY b DESC) pd FROM t1;
a	b	pd
NULL	NULL	2147483647
a	12	12
a	13	13
b	14	14
b	15	15
b	16	16
b	17	17
b	18	18
a	19	19
SELECT a, b, PERCENTILE_DISC(0.5) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY b DESC) pd FROM t1;
a	b	pd
NULL	NULL	2147483647
a	12	12
a	13	13
b	14	14
b	15	15
b	16	16
b	17	17
b	18	18
a	19	19
SELECT a, b, PERCENTILE_DISC(0.6) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY b DESC) pd FROM t1;
a	b	pd
NULL	NULL	2147483647
a	12	12
a	13	13
b	14	14
b	15	15
b	16	16
b	17	17
b	18	18
a	19	19
SELECT a, b, PERCENTILE_DISC(0.61) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY b DESC) pd FROM t1;
a	b	pd
NULL	NULL	2147483647
a	12	12
a	13	13
b	14	14
b	15	15
b	16	16
b	17	17
b	18	18
a	19	19
SELECT a, b, PERCENTILE_DISC(0.65) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY b DESC) pd FROM t1;
a	b	pd
NULL	NULL	2147483647
a	12	12
a	13	13
b	14	14
b	15	15
b	16	16
b	17	17
b	18	18
a	19	19
SELECT a, b, PERCENTILE_DISC(0.69) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY b DESC) pd FROM t1;
a	b	pd
NULL	NULL	2147483647
a	12	12
a	13	13
b	14	14
b	15	15
b	16	16
b	17	17
b	18	18
a	19	19
SELECT a, b, PERCENTILE_DISC(0.7) WITHIN GROUP(ORDER BY b) OVER(PARTITION BY b DESC) pd FROM t1;
a	b	pd
NULL	NULL	2147483647
a	12	12
a	13	13
b	14	14
b	15	15
b	16	16
b	17	17
b	18	18
a	19	19
SELECT a, b, PERCENTILE_DISC(0) WITHIN GROUP(ORDER BY b DESC) OVER(PARTITION BY b) pd FROM t1;
a	b	pd
NULL	NULL	2147483647
a	12	12
a	13	13
b	14	14
b	15	15
b	16	16
b	17	17
b	18	18
a	19	19
SELECT a, b, PERCENTILE_DISC(0) WITHIN GROUP(ORDER BY b DESC) OVER(PARTITION BY a) pd FROM t1;
a	b	pd
NULL	NULL	2147483647
a	19	19
a	13	19
a	12	19
b	18	18
b	17	18
b	16	18
b	15	18
b	14	18
SELECT a, b, PERCENTILE_DISC(0) WITHIN GROUP(ORDER BY a DESC) OVER(PARTITION BY a DESC) pd FROM t1;
a	b	pd
NULL	NULL	NULL
a	19	a
a	13	a
a	12	a
b	17	b
b	18	b
b	14	b
b	15	b
b	16	b
SELECT a, b, PERCENTILE_DISC(1) WITHIN GROUP(ORDER BY a DESC) OVER(PARTITION BY a DESC) pd FROM t1;
a	b	pd
NULL	NULL	NULL
a	19	a
a	13	a
a	12	a
b	17	b
b	18	b
b	14	b
b	15	b
b	16	b
SELECT a, b, PERCENTILE_DISC(0.5) WITHIN GROUP(ORDER BY a DESC) OVER(PARTITION BY a DESC) pd FROM t1;
a	b	pd
NULL	NULL	NULL
a	19	a
a	13	a
a	12	a
b	17	b
b	18	b
b	14	b
b	15	b
b	16	b
SELECT a, b, PERCENTILE_DISC(0) WITHIN GROUP(ORDER BY a DESC) OVER(PARTITION BY b DESC) pd FROM t1;
a	b	pd
NULL	NULL	NULL
a	12	a
a	13	a
b	14	b
b	15	b
b	16	b
b	17	b
b	18	b
a	19	a
SELECT a, b, PERCENTILE_DISC(1) WITHIN GROUP(ORDER BY a DESC) OVER(PARTITION BY b DESC) pd FROM t1;
a	b	pd
NULL	NULL	NULL
a	12	a
a	13	a
b	14	b
b	15	b
b	16	b
b	17	b
b	18	b
a	19	a
SELECT a, b, PERCENTILE_DISC(0.5) WITHIN GROUP(ORDER BY a DESC) OVER(PARTITION BY b DESC) pd FROM t1;
a	b	pd
NULL	NULL	NULL
a	12	a
a	13	a
b	14	b
b	15	b
b	16	b
b	17	b
b	18	b
a	19	a
SELECT a, b, PERCENTILE_DISC(-0.9) WITHIN GROUP(ORDER BY b DESC) OVER(PARTITION BY b DESC) pd FROM t1;
ERROR HY000: Internal error: MCS-9027: Argument '-0.9' is out of range.
SELECT a, b, PERCENTILE_DISC(-1) WITHIN GROUP(ORDER BY b DESC) OVER(PARTITION BY b DESC) pd FROM t1;
ERROR HY000: Internal error: MCS-9027: Argument '-1' is out of range.
SELECT a, b, PERCENTILE_DISC(1.1) WITHIN GROUP(ORDER BY b DESC) OVER(PARTITION BY b DESC) pd FROM t1;
ERROR HY000: Internal error: MCS-9027: Argument '1.1' is out of range.
DROP DATABASE mcs133_db;
