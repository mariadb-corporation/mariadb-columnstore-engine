DROP DATABASE IF EXISTS mcs145_db;
CREATE DATABASE mcs145_db;
USE mcs145_db;
CREATE TABLE t1 (a CHAR(1), b INT)ENGINE=Columnstore;
INSERT INTO t1 VALUES ('', NULL),('a', 12),('a', 13),('b', 14),('b', 15),('b', 16),('b', 17),('b', 18),('a', 19);
SELECT a, b, VARIANCE(b) OVER(PARTITION BY a) variance FROM t1;
a	b	variance
NULL	NULL	NULL
a	19	9.5556
a	13	9.5556
a	12	9.5556
b	17	2.0000
b	18	2.0000
b	14	2.0000
b	15	2.0000
b	16	2.0000
SELECT a, b, VARIANCE(b) OVER(PARTITION BY a DESC) variance FROM t1;
a	b	variance
NULL	NULL	NULL
a	19	9.5556
a	13	9.5556
a	12	9.5556
b	17	2.0000
b	18	2.0000
b	14	2.0000
b	15	2.0000
b	16	2.0000
SELECT a, b, VARIANCE(b) OVER(PARTITION BY b DESC) variance FROM t1;
a	b	variance
NULL	NULL	NULL
a	12	0.0000
a	13	0.0000
b	14	0.0000
b	15	0.0000
b	16	0.0000
b	17	0.0000
b	18	0.0000
a	19	0.0000
SELECT a, b, VARIANCE(b) OVER(PARTITION BY b) variance FROM t1;
a	b	variance
NULL	NULL	NULL
a	12	0.0000
a	13	0.0000
b	14	0.0000
b	15	0.0000
b	16	0.0000
b	17	0.0000
b	18	0.0000
a	19	0.0000
SELECT a, b, VARIANCE(b) OVER(ORDER BY a) variance FROM t1;
a	b	variance
NULL	NULL	NULL
a	19	9.5556
a	13	9.5556
a	12	9.5556
b	17	5.2500
b	18	5.2500
b	14	5.2500
b	15	5.2500
b	16	5.2500
SELECT a, b, VARIANCE(b) OVER(ORDER BY b) variance FROM t1;
a	b	variance
NULL	NULL	NULL
a	12	0.0000
a	13	0.2500
b	14	0.6667
b	15	1.2500
b	16	2.0000
b	17	2.9167
b	18	4.0000
a	19	5.2500
SELECT a, b, VARIANCE(b) OVER(ORDER BY a DESC) variance FROM t1;
a	b	variance
b	16	2.0000
b	15	2.0000
b	18	2.0000
b	17	2.0000
b	14	2.0000
a	19	5.2500
a	12	5.2500
a	13	5.2500
NULL	NULL	5.2500
SELECT a, b, VARIANCE(b) OVER(ORDER BY b DESC) variance FROM t1;
a	b	variance
a	19	0.0000
b	18	0.2500
b	17	0.6667
b	16	1.2500
b	15	2.0000
b	14	2.9167
a	13	4.0000
a	12	5.2500
NULL	NULL	5.2500
SELECT a, b, VARIANCE(b) OVER(PARTITION BY a ORDER BY b) variance FROM t1;
a	b	variance
NULL	NULL	NULL
a	12	0.0000
a	13	0.2500
a	19	9.5556
b	14	0.0000
b	15	0.2500
b	16	0.6667
b	17	1.2500
b	18	2.0000
SELECT a, b, VARIANCE(b) OVER(PARTITION BY b ORDER BY a) variance FROM t1;
a	b	variance
NULL	NULL	NULL
a	12	0.0000
a	13	0.0000
b	14	0.0000
b	15	0.0000
b	16	0.0000
b	17	0.0000
b	18	0.0000
a	19	0.0000
SELECT a, b, VARIANCE(b) OVER(PARTITION BY b ORDER BY b DESC) variance FROM t1;
a	b	variance
NULL	NULL	NULL
a	12	0.0000
a	13	0.0000
b	14	0.0000
b	15	0.0000
b	16	0.0000
b	17	0.0000
b	18	0.0000
a	19	0.0000
SELECT a, b, VARIANCE(b) OVER(PARTITION BY a ORDER BY a DESC) variance FROM t1;
a	b	variance
NULL	NULL	NULL
a	19	9.5556
a	13	9.5556
a	12	9.5556
b	17	2.0000
b	18	2.0000
b	14	2.0000
b	15	2.0000
b	16	2.0000
DROP DATABASE mcs145_db;
