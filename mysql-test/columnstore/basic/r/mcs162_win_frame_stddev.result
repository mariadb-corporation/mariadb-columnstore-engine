DROP DATABASE IF EXISTS mcs162_db;
CREATE DATABASE mcs162_db;
USE mcs162_db;
CREATE TABLE t1 (a CHAR(1), b INT)ENGINE=Columnstore;
INSERT INTO t1 VALUES ('', NULL),('a', 12),('a', 13),('b', 14),('c', 15),('d', 16),('d', 17),('b', 18),('a', 19);
SELECT a, b, STDDEV(b) OVER(ORDER BY b RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) stddev FROM t1;
a	b	stddev
NULL	NULL	NULL
a	12	0.0000
a	13	0.5000
b	14	0.8165
c	15	1.1180
d	16	1.4142
d	17	1.7078
b	18	2.0000
a	19	2.2913
SELECT a, b, STDDEV(b) OVER(ORDER BY b RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) stddev FROM t1;
a	b	stddev
NULL	NULL	2.2913
a	12	2.2913
a	13	2.0000
b	14	1.7078
c	15	1.4142
d	16	1.1180
d	17	0.8165
b	18	0.5000
a	19	0.0000
SELECT a, b, STDDEV(b) OVER(ORDER BY b ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) stddev FROM t1;
a	b	stddev
NULL	NULL	NULL
a	12	0.0000
a	13	0.5000
b	14	0.5000
c	15	0.5000
d	16	0.5000
d	17	0.5000
b	18	0.5000
a	19	0.5000
SELECT a, b, STDDEV(b) OVER(ORDER BY b ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) stddev FROM t1;
a	b	stddev
NULL	NULL	0.0000
a	12	0.5000
a	13	0.8165
b	14	0.8165
c	15	0.8165
d	16	0.8165
d	17	0.8165
b	18	0.8165
a	19	0.5000
SELECT a, b, STDDEV(b) OVER(ORDER BY b ROWS BETWEEN 1 PRECEDING AND UNBOUNDED FOLLOWING) stddev FROM t1;
a	b	stddev
NULL	NULL	2.2913
a	12	2.2913
a	13	2.2913
b	14	2.0000
c	15	1.7078
d	16	1.4142
d	17	1.1180
b	18	0.8165
a	19	0.5000
SELECT a, b, STDDEV(b) OVER(ORDER BY b DESC RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) stddev FROM t1;
a	b	stddev
a	19	0.0000
b	18	0.5000
d	17	0.8165
d	16	1.1180
c	15	1.4142
b	14	1.7078
a	13	2.0000
a	12	2.2913
NULL	NULL	2.2913
SELECT a, b, STDDEV(b) OVER(ORDER BY b DESC RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) stddev FROM t1;
a	b	stddev
a	19	2.2913
b	18	2.0000
d	17	1.7078
d	16	1.4142
c	15	1.1180
b	14	0.8165
a	13	0.5000
a	12	0.0000
NULL	NULL	NULL
SELECT a, b, STDDEV(b) OVER(ORDER BY b DESC ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) stddev FROM t1;
a	b	stddev
a	19	0.0000
b	18	0.5000
d	17	0.5000
d	16	0.5000
c	15	0.5000
b	14	0.5000
a	13	0.5000
a	12	0.5000
NULL	NULL	0.0000
SELECT a, b, STDDEV(b) OVER(ORDER BY b DESC ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) stddev FROM t1;
a	b	stddev
a	19	0.5000
b	18	0.8165
d	17	0.8165
d	16	0.8165
c	15	0.8165
b	14	0.8165
a	13	0.8165
a	12	0.5000
NULL	NULL	0.0000
SELECT a, b, STDDEV(b) OVER(ORDER BY b DESC ROWS BETWEEN 1 PRECEDING AND UNBOUNDED FOLLOWING) stddev FROM t1;
a	b	stddev
a	19	2.2913
b	18	2.2913
d	17	2.0000
d	16	1.7078
c	15	1.4142
b	14	1.1180
a	13	0.8165
a	12	0.5000
NULL	NULL	0.0000
SELECT a, b, STDDEV(b) OVER(PARTITION BY a ORDER BY b RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) stddev FROM t1;
a	b	stddev
NULL	NULL	NULL
a	12	0.0000
a	13	0.5000
a	19	3.0912
b	14	0.0000
b	18	2.0000
c	15	0.0000
d	16	0.0000
d	17	0.5000
SELECT a, b, STDDEV(b) OVER(PARTITION BY b ORDER BY b RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) stddev FROM t1;
a	b	stddev
NULL	NULL	NULL
a	12	0.0000
a	13	0.0000
b	14	0.0000
c	15	0.0000
d	16	0.0000
d	17	0.0000
b	18	0.0000
a	19	0.0000
SELECT a, b, STDDEV(b) OVER(PARTITION BY a ORDER BY b RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) stddev FROM t1;
a	b	stddev
NULL	NULL	NULL
a	12	3.0912
a	13	3.0000
a	19	0.0000
b	14	2.0000
b	18	0.0000
c	15	0.0000
d	16	0.5000
d	17	0.0000
SELECT a, b, STDDEV(b) OVER(PARTITION BY b ORDER BY b RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) stddev FROM t1;
a	b	stddev
NULL	NULL	NULL
a	12	0.0000
a	13	0.0000
b	14	0.0000
c	15	0.0000
d	16	0.0000
d	17	0.0000
b	18	0.0000
a	19	0.0000
SELECT a, b, STDDEV(b) OVER(PARTITION BY a ORDER BY b ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) stddev FROM t1;
a	b	stddev
NULL	NULL	NULL
a	12	0.0000
a	13	0.5000
a	19	3.0000
b	14	0.0000
b	18	2.0000
c	15	0.0000
d	16	0.0000
d	17	0.5000
SELECT a, b, STDDEV(b) OVER(PARTITION BY b ORDER BY b ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) stddev FROM t1;
a	b	stddev
NULL	NULL	NULL
a	12	0.0000
a	13	0.0000
b	14	0.0000
c	15	0.0000
d	16	0.0000
d	17	0.0000
b	18	0.0000
a	19	0.0000
SELECT a, b, STDDEV(b) OVER(PARTITION BY a ORDER BY b ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) stddev FROM t1;
a	b	stddev
NULL	NULL	NULL
a	12	0.5000
a	13	3.0912
a	19	3.0000
b	14	2.0000
b	18	2.0000
c	15	0.0000
d	16	0.5000
d	17	0.5000
SELECT a, b, STDDEV(b) OVER(PARTITION BY b ORDER BY b ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) stddev FROM t1;
a	b	stddev
NULL	NULL	NULL
a	12	0.0000
a	13	0.0000
b	14	0.0000
c	15	0.0000
d	16	0.0000
d	17	0.0000
b	18	0.0000
a	19	0.0000
SELECT a, b, STDDEV(b) OVER(PARTITION BY a ORDER BY b ROWS BETWEEN 1 PRECEDING AND UNBOUNDED FOLLOWING) stddev FROM t1;
a	b	stddev
NULL	NULL	NULL
a	12	3.0912
a	13	3.0912
a	19	3.0000
b	14	2.0000
b	18	2.0000
c	15	0.0000
d	16	0.5000
d	17	0.5000
SELECT a, b, STDDEV(b) OVER(PARTITION BY b ORDER BY b ROWS BETWEEN 1 PRECEDING AND UNBOUNDED FOLLOWING) stddev FROM t1;
a	b	stddev
NULL	NULL	NULL
a	12	0.0000
a	13	0.0000
b	14	0.0000
c	15	0.0000
d	16	0.0000
d	17	0.0000
b	18	0.0000
a	19	0.0000
SELECT a, b, STDDEV(b) OVER(PARTITION BY b RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) stddev FROM t1;
ERROR HY000: RANGE-type frame requires ORDER BY clause with single sort key
SELECT a, b, STDDEV(b) OVER(ORDER BY a RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) stddev FROM t1;
ERROR HY000: Numeric datatype is required for RANGE-type frame
DROP DATABASE mcs162_db;
