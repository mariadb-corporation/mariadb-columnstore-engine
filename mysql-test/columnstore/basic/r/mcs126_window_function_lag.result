DROP DATABASE IF EXISTS mcs126_db;
CREATE DATABASE mcs126_db;
USE mcs126_db;
CREATE TABLE t1 (a CHAR(1), b INT)ENGINE=Columnstore;
INSERT INTO t1 VALUES ('', NULL),('a', 123),('a', 1),('b', 123),('c', 1861),('c', 1991),('d', 10701),('d', 1071),('a', 92);
SELECT a, b, LAG(a) OVER(ORDER BY a) pc FROM t1;
a	b	pc
NULL	NULL	NULL
a	92	NULL
a	1	a
a	123	a
b	123	a
c	1991	b
c	1861	c
d	1071	c
d	10701	d
SELECT a, b, LAG(b) OVER(ORDER BY b DESC) pc FROM t1;
a	b	pc
d	10701	NULL
c	1991	10701
c	1861	1991
d	1071	1861
a	123	1071
b	123	123
a	92	123
a	1	92
NULL	NULL	1
SELECT a, b, LAG(a) OVER(ORDER BY b) pc FROM t1;
a	b	pc
NULL	NULL	NULL
a	1	NULL
a	92	a
b	123	a
a	123	b
d	1071	a
c	1861	d
c	1991	c
d	10701	c
SELECT a, b, LAG(b) OVER(ORDER BY a DESC) pc FROM t1;
a	b	pc
d	10701	NULL
d	1071	10701
c	1861	1071
c	1991	1861
b	123	1991
a	92	123
a	123	92
a	1	123
NULL	NULL	1
SELECT a, b, LAG(a) OVER w lag_value FROM t1 WINDOW w AS (ORDER BY a DESC);
a	b	lag_value
d	10701	NULL
d	1071	d
c	1861	d
c	1991	c
b	123	c
a	92	b
a	123	a
a	1	a
NULL	NULL	a
SELECT a, b, LAG(b) OVER w lag_value FROM t1 WINDOW w AS (ORDER BY b);
a	b	lag_value
NULL	NULL	NULL
a	1	NULL
a	92	1
b	123	92
a	123	123
d	1071	123
c	1861	1071
c	1991	1861
d	10701	1991
SELECT a, b, LAG(a) OVER(PARTITION BY a ORDER BY a DESC) lag_value FROM t1;
a	b	lag_value
NULL	NULL	NULL
a	92	NULL
a	1	a
a	123	a
b	123	NULL
c	1991	NULL
c	1861	c
d	1071	NULL
d	10701	d
SELECT a, b, LAG(a) OVER(PARTITION BY a ORDER BY b DESC) lag_value FROM t1;
a	b	lag_value
NULL	NULL	NULL
a	123	NULL
a	92	a
a	1	a
b	123	NULL
c	1991	NULL
c	1861	c
d	10701	NULL
d	1071	d
SELECT a, b, LAG(a) OVER(PARTITION BY a ORDER BY b ASC) lag_value FROM t1;
a	b	lag_value
NULL	NULL	NULL
a	1	NULL
a	92	a
a	123	a
b	123	NULL
c	1861	NULL
c	1991	c
d	1071	NULL
d	10701	d
SELECT a, b, LAG(a) OVER(PARTITION BY b ORDER BY a DESC) lag_value FROM t1;
a	b	lag_value
NULL	NULL	NULL
a	1	NULL
a	92	NULL
b	123	NULL
a	123	b
d	1071	NULL
c	1861	NULL
c	1991	NULL
d	10701	NULL
SELECT a, b, LAG(a) OVER(PARTITION BY b ORDER BY b DESC) lag_value FROM t1;
a	b	lag_value
NULL	NULL	NULL
a	1	NULL
a	92	NULL
b	123	NULL
a	123	b
d	1071	NULL
c	1861	NULL
c	1991	NULL
d	10701	NULL
SELECT a, b, LAG(b) OVER(PARTITION BY a ORDER BY a DESC) lag_value FROM t1;
a	b	lag_value
NULL	NULL	NULL
a	92	NULL
a	1	92
a	123	1
b	123	NULL
c	1991	NULL
c	1861	1991
d	1071	NULL
d	10701	1071
SELECT a, b, LAG(b) OVER(PARTITION BY a ORDER BY b DESC) lag_value FROM t1;
a	b	lag_value
NULL	NULL	NULL
a	123	NULL
a	92	123
a	1	92
b	123	NULL
c	1991	NULL
c	1861	1991
d	10701	NULL
d	1071	10701
SELECT a, b, LAG(b) OVER(PARTITION BY a ORDER BY b ASC) lag_value FROM t1;
a	b	lag_value
NULL	NULL	NULL
a	1	NULL
a	92	1
a	123	92
b	123	NULL
c	1861	NULL
c	1991	1861
d	1071	NULL
d	10701	1071
SELECT a, b, LAG(b) OVER(PARTITION BY b ORDER BY a DESC) lag_value FROM t1;
a	b	lag_value
NULL	NULL	NULL
a	1	NULL
a	92	NULL
b	123	NULL
a	123	123
d	1071	NULL
c	1861	NULL
c	1991	NULL
d	10701	NULL
SELECT a, b, LAG(b) OVER(PARTITION BY b ORDER BY b DESC) lag_value FROM t1;
a	b	lag_value
NULL	NULL	NULL
a	1	NULL
a	92	NULL
b	123	NULL
a	123	123
d	1071	NULL
c	1861	NULL
c	1991	NULL
d	10701	NULL
SELECT a, b, LAG(a) OVER(PARTITION BY b) lag_value FROM t1;
ERROR HY000: No order list in window specification for 'lag'
SELECT a, b, LAG(a) OVER(PARTITION BY a) lag_value FROM t1;
ERROR HY000: No order list in window specification for 'lag'
DROP DATABASE mcs126_db;
