DROP DATABASE IF EXISTS mcs144_db;
CREATE DATABASE mcs144_db;
USE mcs144_db;
CREATE TABLE t1 (a CHAR(1), b INT)ENGINE=Columnstore;
INSERT INTO t1 VALUES ('', NULL),('a', 12),('a', 13),('b', 14),('b', 15),('b', 16),('b', 17),('b', 18),('a', 19);
SELECT a, b, STDDEV_SAMP(b) OVER(PARTITION BY a) pd FROM t1;
a	b	pd
NULL	NULL	NULL
a	19	3.7859
a	13	3.7859
a	12	3.7859
b	17	1.5811
b	18	1.5811
b	14	1.5811
b	15	1.5811
b	16	1.5811
SELECT a, b, STDDEV_SAMP(b) OVER(PARTITION BY a DESC) pd FROM t1;
a	b	pd
NULL	NULL	NULL
a	19	3.7859
a	13	3.7859
a	12	3.7859
b	17	1.5811
b	18	1.5811
b	14	1.5811
b	15	1.5811
b	16	1.5811
SELECT a, b, STDDEV_SAMP(b) OVER(PARTITION BY b DESC) pd FROM t1;
a	b	pd
NULL	NULL	NULL
a	12	NULL
a	13	NULL
b	14	NULL
b	15	NULL
b	16	NULL
b	17	NULL
b	18	NULL
a	19	NULL
SELECT a, b, STDDEV_SAMP(b) OVER(PARTITION BY b) pd FROM t1;
a	b	pd
NULL	NULL	NULL
a	12	NULL
a	13	NULL
b	14	NULL
b	15	NULL
b	16	NULL
b	17	NULL
b	18	NULL
a	19	NULL
SELECT a, b, STDDEV_SAMP(b) OVER(ORDER BY a) pd FROM t1;
a	b	pd
NULL	NULL	NULL
a	19	3.7859
a	13	3.7859
a	12	3.7859
b	17	2.4495
b	18	2.4495
b	14	2.4495
b	15	2.4495
b	16	2.4495
SELECT a, b, STDDEV_SAMP(b) OVER(ORDER BY b) pd FROM t1;
a	b	pd
NULL	NULL	NULL
a	12	NULL
a	13	0.7071
b	14	1.0000
b	15	1.2910
b	16	1.5811
b	17	1.8708
b	18	2.1602
a	19	2.4495
SELECT a, b, STDDEV_SAMP(b) OVER(ORDER BY a DESC) pd FROM t1;
a	b	pd
b	16	1.5811
b	15	1.5811
b	18	1.5811
b	17	1.5811
b	14	1.5811
a	19	2.4495
a	12	2.4495
a	13	2.4495
NULL	NULL	2.4495
SELECT a, b, STDDEV_SAMP(b) OVER(ORDER BY b DESC) pd FROM t1;
a	b	pd
a	19	NULL
b	18	0.7071
b	17	1.0000
b	16	1.2910
b	15	1.5811
b	14	1.8708
a	13	2.1602
a	12	2.4495
NULL	NULL	2.4495
SELECT a, b, STDDEV_SAMP(b) OVER(PARTITION BY a ORDER BY b) pd FROM t1;
a	b	pd
NULL	NULL	NULL
a	12	NULL
a	13	0.7071
a	19	3.7859
b	14	NULL
b	15	0.7071
b	16	1.0000
b	17	1.2910
b	18	1.5811
SELECT a, b, STDDEV_SAMP(b) OVER(PARTITION BY b ORDER BY a) pd FROM t1;
a	b	pd
NULL	NULL	NULL
a	12	NULL
a	13	NULL
b	14	NULL
b	15	NULL
b	16	NULL
b	17	NULL
b	18	NULL
a	19	NULL
SELECT a, b, STDDEV_SAMP(b) OVER(PARTITION BY b ORDER BY b DESC) pd FROM t1;
a	b	pd
NULL	NULL	NULL
a	12	NULL
a	13	NULL
b	14	NULL
b	15	NULL
b	16	NULL
b	17	NULL
b	18	NULL
a	19	NULL
SELECT a, b, STDDEV_SAMP(b) OVER(PARTITION BY a ORDER BY a DESC) pd FROM t1;
a	b	pd
NULL	NULL	NULL
a	19	3.7859
a	13	3.7859
a	12	3.7859
b	17	1.5811
b	18	1.5811
b	14	1.5811
b	15	1.5811
b	16	1.5811
DROP DATABASE mcs144_db;
