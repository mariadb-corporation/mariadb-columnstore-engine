DROP DATABASE IF EXISTS mcs251_db;
CREATE DATABASE mcs251_db;
USE mcs251_db;
CREATE TABLE t1
(
t1_INT INT,
t1_TIME TIME,
t1_DATETIME DATETIME
)ENGINE=Columnstore;
INSERT INTO t1 VALUES(1, '22:12:02', '1997-12-12 22:12:02');
INSERT INTO t1 VALUES(2, '23:59:59', '2001-1-1 23:59:59');
INSERT INTO t1 VALUES(3, '01:00:00', '09-12-11 01:08:59');
SELECT TIME_TO_SEC('00:00:00') FROM t1 LIMIT 1;
TIME_TO_SEC('00:00:00')
0
SELECT TIME_TO_SEC('24:00:00') FROM t1 LIMIT 1;
TIME_TO_SEC('24:00:00')
86400
SELECT TIME_TO_SEC('10:50:40.9999') FROM t1 LIMIT 1;
TIME_TO_SEC('10:50:40.9999')
39040.9999
SELECT t1_TIME, TIME_TO_SEC(t1_TIME) FROM t1 ORDER BY 1;
t1_TIME	TIME_TO_SEC(t1_TIME)
01:00:00	3600
22:12:02	79922
23:59:59	86399
SELECT t1_DATETIME, TIME_TO_SEC(t1_DATETIME) FROM t1 ORDER BY 1;
t1_DATETIME	TIME_TO_SEC(t1_DATETIME)
1997-12-12 22:12:02	79922
2001-01-01 23:59:59	86399
2009-12-11 01:08:59	4139
DROP TABLE t1;
#
# MCOL-4743 Regression: TIME_TO_SEC(const_expr) erroneosly returns 0
#
CREATE TABLE t1 (a INT) ENGINE=ColumnStore;
INSERT INTO t1 VALUES (1);
SELECT TIME_TO_SEC('10:50:40.9999') FROM t1;
TIME_TO_SEC('10:50:40.9999')
39040.9999
DROP TABLE t1;
DROP DATABASE mcs251_db;
