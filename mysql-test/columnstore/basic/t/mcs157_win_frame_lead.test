#
# Test LEAD() Window Frame
# Author: Bharath, bharath.bokka@mariadb.com
#
-- source ../include/have_columnstore.inc

--disable_warnings
DROP DATABASE IF EXISTS mcs157_db;
--enable_warnings

CREATE DATABASE mcs157_db;
USE mcs157_db;

CREATE TABLE t1 (a CHAR(1), b INT)ENGINE=Columnstore;
INSERT INTO t1 VALUES ('', NULL),('a', 12),('a', 13),('b', 14),('c', 15),('d', 16),('d', 17),('b', 18),('a', 19);

SELECT a, b, LEAD(b) OVER(ORDER BY b RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) lead_value FROM t1;
SELECT a, b, LEAD(b) OVER(ORDER BY b RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) lead_value FROM t1;
SELECT a, b, LEAD(b, 2) OVER(ORDER BY b ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) lead_value FROM t1;
SELECT a, b, LEAD(b, 0) OVER(ORDER BY b ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) lead_value FROM t1;
SELECT a, b, LEAD(b, -1) OVER(ORDER BY b ROWS BETWEEN 1 PRECEDING AND UNBOUNDED FOLLOWING) lead_value FROM t1;
			 
SELECT a, b, LEAD(a) OVER(ORDER BY b DESC RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) lead_value FROM t1;
SELECT a, b, LEAD(a) OVER(ORDER BY b DESC RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) lead_value FROM t1;
SELECT a, b, LEAD(a) OVER(ORDER BY b DESC ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) lead_value FROM t1;
SELECT a, b, LEAD(a) OVER(ORDER BY b DESC ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) lead_value FROM t1;
SELECT a, b, LEAD(a) OVER(ORDER BY b DESC ROWS BETWEEN 1 PRECEDING AND UNBOUNDED FOLLOWING) lead_value FROM t1;
			 
SELECT a, b, LEAD(b) OVER(PARTITION BY a ORDER BY b RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) lead_value FROM t1;
SELECT a, b, LEAD(b) OVER(PARTITION BY b ORDER BY b RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) lead_value FROM t1;
SELECT a, b, LEAD(b) OVER(PARTITION BY a ORDER BY b RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) lead_value FROM t1;
SELECT a, b, LEAD(b) OVER(PARTITION BY b ORDER BY b RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) lead_value FROM t1;
SELECT a, b, LEAD(b) OVER(PARTITION BY a ORDER BY b ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) lead_value FROM t1;
SELECT a, b, LEAD(b) OVER(PARTITION BY b ORDER BY b ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) lead_value FROM t1;
SELECT a, b, LEAD(b) OVER(PARTITION BY a ORDER BY b ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) lead_value FROM t1;
SELECT a, b, LEAD(b) OVER(PARTITION BY b ORDER BY b ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) lead_value FROM t1;
SELECT a, b, LEAD(b) OVER(PARTITION BY a ORDER BY b ROWS BETWEEN 1 PRECEDING AND UNBOUNDED FOLLOWING) lead_value FROM t1;
SELECT a, b, LEAD(b) OVER(PARTITION BY b ORDER BY b ROWS BETWEEN 1 PRECEDING AND UNBOUNDED FOLLOWING) lead_value FROM t1;

--error ER_NO_ORDER_LIST_IN_WINDOW_SPEC
SELECT a, b, LEAD(b) OVER(PARTITION BY b RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) lead_value FROM t1;
--error ER_WRONG_TYPE_FOR_RANGE_FRAME
SELECT a, b, LEAD(b) OVER(ORDER BY a RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) lead_value FROM t1;

# Clean UP
DROP DATABASE mcs157_db;
