#
# Test MODA Function
# Author: dhall, david.hall@mariadb.com
#
# Test MODA with various numeric types
-- source ../include/have_columnstore.inc

--disable_warnings
DROP DATABASE IF EXISTS mcs98_db;
--enable_warnings

CREATE DATABASE mcs98_db;
USE mcs98_db;

CREATE TABLE t1 (t TINYINT, s SMALLINT, m MEDIUMINT, i INT, d1 DECIMAL(5,2), d2 DECIMAL(36,12), rl FLOAT, dbl DOUBLE)ENGINE=Columnstore;
INSERT INTO t1 VALUES(NULL, NULL, 1234, 700000012898, 34.21, 90000000000000000009.124312000091, 14.01, 3900000000000001.23), 
                     (12, 345, 1234, 700000012898, 34.21, 90000000000000000009.124312000091, 14.01, 3900000000000001.23), 
                     (12, 345, 1234, 700000012899, 34.22, 90000000000000000009.124312000092, 14.02, 3900000000000001.24), 
                     (13, 346, 1235, NULL, NULL, NULL, NULL, NULL), 
                     (28, 1345, 11234, 1700000012899, 134.22, 190000000000000000009.124312000092, 114.02, 13900000000000001.24);

SELECT moda(t) FROM t1;
SELECT moda(s) FROM t1;
SELECT moda(m) FROM t1;
SELECT moda(i) FROM t1;
SELECT moda(d1) FROM t1;
SELECT moda(d2) FROM t1;
SELECT moda(rl) FROM t1;
SELECT moda(dbl) FROM t1;
# Clean UP
DROP DATABASE mcs98_db;
