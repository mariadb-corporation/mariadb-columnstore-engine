-- source ../include/have_columnstore.inc

--disable_warnings
DROP DATABASE IF EXISTS mcol641_sorting_db;
--enable_warnings

CREATE DATABASE mcol641_sorting_db;
USE mcol641_sorting_db;

CREATE TABLE cs1 (d1 DECIMAL(38), d2 DECIMAL(38,10), d3 DECIMAL(38,38), d4 DECIMAL(38),d5 DECIMAL(38),i1 INT) ENGINE=columnstore;
CREATE TABLE cs2 (d1 DECIMAL(38) UNSIGNED, d2 DECIMAL(38,10) UNSIGNED, d3 DECIMAL(38,38) UNSIGNED, d4 DECIMAL(38),d5 DECIMAL(38),i1 INT) ENGINE=columnstore;

INSERT INTO cs1 VALUES
    (1234,5678,-0.12345678901234567890123456789018,2,1,1),     
    (1234,-5678,0.1234567890123456789012345,2,1,1),
    (12345678901234567890123,1234567890123456789012.9012345678,0.123456789012345678901234567890,2,1,1),
    (NULL,NULL,NULL,2,1,1),
    (0,0,0,2,1,1),
    (1234,5678,0.1234567890123456783456789012345678,3,2,2),
    (-123456789123456789,-5678,0.123456789012345673456789012345678,3,2,2),
    (12345678901234567890901,1234567890123478901234.9012345678,0.1234567890123456789012345678908,3,2,2),
    (NULL,NULL,NULL,3,2,2),
    (0,0,0,3,2,2),
    (1234,5678,-0.12345678901234567890123456789018,11111111111111111111111111111111,1,1),
    (1234,5678,-0.12345678901234567890123456789018,11111111111111111111111111111111,1,1),
    (1234,5678,-0.12345678901234567890123456789018,11111111111111111111111111111112,1,1); 

INSERT INTO cs2 VALUES
    (1234,5678,0.12345678901234567890123456789018,2,1,1),     
    (1234,5678,0.1234567890123456789012345,2,1,1),
    (12345678901234567890123,1234567890123456789012.9012345678,0.123456789012345678901234567890,2,1,1),
    (NULL,NULL,NULL,2,1,1),
    (0,0,0,2,1,1),
    (1234,5678,0.1234567890123456783456789012345678,3,2,2),
    (123456789123456789,5678,0.123456789012345673456789012345678,3,2,2),
    (12345678901234567890901,1234567890123478901234.9012345678,0.1234567890123456789012345678908,3,2,2),
    (NULL,NULL,NULL,3,2,2),
    (0,0,0,3,2,2),
    (1234,5678,0.12345678901234567890123456789018,11111111111111111111111111111111,1,1),
    (1234,5678,0.12345678901234567890123456789018,11111111111111111111111111111111,1,1),
    (1234,5678,0.12345678901234567890123456789018,11111111111111111111111111111112,1,1); 

# ORDER BY
SELECT 't1_q1',d1,d5 FROM cs1 ORDER BY d1,d5;
SELECT 't1_q2',d2,d5 FROM cs1 ORDER BY d2,d5;
SELECT 't1_q3',d3,d5 FROM cs1 ORDER BY d3,d5;

# LIMIT
SELECT 't2_q1',d1,d5 FROM cs1 ORDER BY d1,d5 LIMIT 1 OFFSET 2;
SELECT 't2_q2',d2,d5 FROM cs1 ORDER BY d2,d5 LIMIT 1 OFFSET 2;
SELECT 't2_q3',d3,d5 FROM cs1 ORDER BY d3,d5 LIMIT 1 OFFSET 2;

# DISTINCT
SELECT DISTINCT 't3_q1',d1,d5 FROM cs1 ORDER BY d1,d5;
SELECT DISTINCT 't3_q2',d2,d5 FROM cs1 ORDER BY d2,d5;
SELECT DISTINCT 't3_q3',d3,d5 FROM cs1 ORDER BY d3,d5;

# ORDER BY
SELECT 't4_q1',d1,d5 FROM cs1 ORDER BY d1,d5 ASC;
SELECT 't4_q2',d2,d5 FROM cs1 ORDER BY d2,d5 ASC;
SELECT 't4_q3',d3,d5 FROM cs1 ORDER BY d3,d5 ASC;
SELECT 't4_q1',d1,d5 FROM cs1 ORDER BY d1,d5 DESC;
SELECT 't4_q2',d2,d5 FROM cs1 ORDER BY d2,d5 DESC;
SELECT 't4_q3',d3,d5 FROM cs1 ORDER BY d3,d5 DESC;

# ORDER BY
SELECT 't5_q1',d1,d5 FROM cs2 ORDER BY d1,d5;
SELECT 't5_q2',d2,d5 FROM cs2 ORDER BY d2,d5;
SELECT 't5_q3',d3,d5 FROM cs2 ORDER BY d3,d5;

# LIMIT
SELECT 't6_q1',d1,d5 FROM cs2 ORDER BY d1,d5 LIMIT 1 OFFSET 2;
SELECT 't6_q2',d2,d5 FROM cs2 ORDER BY d2,d5 LIMIT 1 OFFSET 2;
SELECT 't6_q3',d3,d5 FROM cs2 ORDER BY d3,d5 LIMIT 1 OFFSET 2;

# DISTINCT
SELECT DISTINCT 't7_q1',d1,d5 FROM cs2 ORDER BY d1,d5;
SELECT DISTINCT 't7_q2',d2,d5 FROM cs2 ORDER BY d2,d5;
SELECT DISTINCT 't7_q3',d3,d5 FROM cs2 ORDER BY d3,d5;

# ORDER BY
SELECT 't8_q1',d1,d5 FROM cs2 ORDER BY d1,d5 ASC;
SELECT 't8_q2',d2,d5 FROM cs2 ORDER BY d2,d5 ASC;
SELECT 't8_q3',d3,d5 FROM cs2 ORDER BY d3,d5 ASC;
SELECT 't8_q1',d1,d5 FROM cs2 ORDER BY d1,d5 DESC;
SELECT 't8_q2',d2,d5 FROM cs2 ORDER BY d2,d5 DESC;
SELECT 't8_q3',d3,d5 FROM cs2 ORDER BY d3,d5 DESC;

# Clean UP
DROP DATABASE mcol641_sorting_db;
