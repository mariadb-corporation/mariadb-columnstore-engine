USE ssb1;
select d_year, s_nation, p_category,
sum(lo_revenue - lo_supplycost) as profit
from customer, supplier, part, dateinfo, lineorder	   # changed order
where lo_custkey = c_custkey
and lo_suppkey = s_suppkey
and lo_partkey = p_partkey
and lo_orderdate = d_datekey
and c_region = 'AMERICA'
and s_region = 'AMERICA'
and (d_year = 1997 or d_year = 1998)
and lo_orderdate between 19970101 and 19981231		   # added matching predicate
and (p_mfgr = 'MFGR#1'
or p_mfgr = 'MFGR#2')
group by d_year, s_nation, p_category
order by d_year, s_nation, p_category;
d_year	s_nation	p_category	profit
1997	ARGENTINA	MFGR#11	1046230125.00
1997	ARGENTINA	MFGR#12	1108301658.00
1997	ARGENTINA	MFGR#13	1076239089.00
1997	ARGENTINA	MFGR#14	1131439492.00
1997	ARGENTINA	MFGR#15	1078746087.00
1997	ARGENTINA	MFGR#21	957263735.00
1997	ARGENTINA	MFGR#22	1031211752.00
1997	ARGENTINA	MFGR#23	1046883608.00
1997	ARGENTINA	MFGR#24	951412143.00
1997	ARGENTINA	MFGR#25	1054327484.00
1997	BRAZIL	MFGR#11	954093212.00
1997	BRAZIL	MFGR#12	1038093317.00
1997	BRAZIL	MFGR#13	1063341981.00
1997	BRAZIL	MFGR#14	1037205025.00
1997	BRAZIL	MFGR#15	925421639.00
1997	BRAZIL	MFGR#21	965589092.00
1997	BRAZIL	MFGR#22	996999098.00
1997	BRAZIL	MFGR#23	1007918298.00
1997	BRAZIL	MFGR#24	1094578535.00
1997	BRAZIL	MFGR#25	1055718671.00
1997	CANADA	MFGR#11	1107648111.00
1997	CANADA	MFGR#12	1000123669.00
1997	CANADA	MFGR#13	1172022564.00
1997	CANADA	MFGR#14	1053363700.00
1997	CANADA	MFGR#15	1059672985.00
1997	CANADA	MFGR#21	1031318213.00
1997	CANADA	MFGR#22	1131105195.00
1997	CANADA	MFGR#23	1081071368.00
1997	CANADA	MFGR#24	1004291452.00
1997	CANADA	MFGR#25	1005065645.00
1997	PERU	MFGR#11	1261604004.00
1997	PERU	MFGR#12	1000222177.00
1997	PERU	MFGR#13	1135148016.00
1997	PERU	MFGR#14	1177303901.00
1997	PERU	MFGR#15	1093903237.00
1997	PERU	MFGR#21	1085650080.00
1997	PERU	MFGR#22	1068901001.00
1997	PERU	MFGR#23	1243191792.00
1997	PERU	MFGR#24	1088650504.00
1997	PERU	MFGR#25	1029659928.00
1997	UNITED STATES	MFGR#11	1040517148.00
1997	UNITED STATES	MFGR#12	1062308744.00
1997	UNITED STATES	MFGR#13	989444729.00
1997	UNITED STATES	MFGR#14	1120496880.00
1997	UNITED STATES	MFGR#15	1081280930.00
1997	UNITED STATES	MFGR#21	900529598.00
1997	UNITED STATES	MFGR#22	1071679717.00
1997	UNITED STATES	MFGR#23	1091519252.00
1997	UNITED STATES	MFGR#24	983128411.00
1997	UNITED STATES	MFGR#25	983183914.00
1998	ARGENTINA	MFGR#11	686392460.00
1998	ARGENTINA	MFGR#12	524836909.00
1998	ARGENTINA	MFGR#13	690523361.00
1998	ARGENTINA	MFGR#14	649476801.00
1998	ARGENTINA	MFGR#15	615799216.00
1998	ARGENTINA	MFGR#21	634110060.00
1998	ARGENTINA	MFGR#22	597419332.00
1998	ARGENTINA	MFGR#23	689697302.00
1998	ARGENTINA	MFGR#24	669199878.00
1998	ARGENTINA	MFGR#25	610484751.00
1998	BRAZIL	MFGR#11	668899901.00
1998	BRAZIL	MFGR#12	561512876.00
1998	BRAZIL	MFGR#13	633186070.00
1998	BRAZIL	MFGR#14	572722037.00
1998	BRAZIL	MFGR#15	651686093.00
1998	BRAZIL	MFGR#21	531465629.00
1998	BRAZIL	MFGR#22	506038184.00
1998	BRAZIL	MFGR#23	645491859.00
1998	BRAZIL	MFGR#24	648560186.00
1998	BRAZIL	MFGR#25	602757291.00
1998	CANADA	MFGR#11	671353176.00
1998	CANADA	MFGR#12	612239521.00
1998	CANADA	MFGR#13	660720266.00
1998	CANADA	MFGR#14	626172058.00
1998	CANADA	MFGR#15	671287287.00
1998	CANADA	MFGR#21	529119747.00
1998	CANADA	MFGR#22	667604878.00
1998	CANADA	MFGR#23	596683357.00
1998	CANADA	MFGR#24	554893189.00
1998	CANADA	MFGR#25	710933244.00
1998	PERU	MFGR#11	750316502.00
1998	PERU	MFGR#12	693122370.00
1998	PERU	MFGR#13	650706633.00
1998	PERU	MFGR#14	578951333.00
1998	PERU	MFGR#15	705353465.00
1998	PERU	MFGR#21	603219507.00
1998	PERU	MFGR#22	704738239.00
1998	PERU	MFGR#23	677041815.00
1998	PERU	MFGR#24	625168316.00
1998	PERU	MFGR#25	794375754.00
1998	UNITED STATES	MFGR#11	682079660.00
1998	UNITED STATES	MFGR#12	565159069.00
1998	UNITED STATES	MFGR#13	565717243.00
1998	UNITED STATES	MFGR#14	599523448.00
1998	UNITED STATES	MFGR#15	511332610.00
1998	UNITED STATES	MFGR#21	554993261.00
1998	UNITED STATES	MFGR#22	633727751.00
1998	UNITED STATES	MFGR#23	623152694.00
1998	UNITED STATES	MFGR#24	650447386.00
1998	UNITED STATES	MFGR#25	584068884.00
