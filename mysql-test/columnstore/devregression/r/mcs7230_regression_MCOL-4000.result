USE tpch1;
DROP TABLE IF EXISTS mcol4000;
CREATE TABLE mcol4000(
l_orderkey INT,
l_partkey INT,
l_suppkey INT,
l_linenumber BIGINT,
l_quantity DECIMAL(12,2),
l_extendedprice DECIMAL(12,2),
l_discount DECIMAL(12,2),
l_tax DECIMAL(12,2),
l_returnflag CHAR (1),
l_linestatus CHAR (1),
l_shipdate DATE,
l_commitdate DATE,
l_receiptdate DATE,
l_shipinstruct CHAR (25),
l_shipmode CHAR (10),
l_comment VARCHAR (44)
) ENGINE=columnstore;
SELECT * FROM lineitem LIMIT 1000000 INTO OUTFILE '/tmp/mcol4000.txt' FIELDS TERMINATED BY ',' ENCLOSED BY '"';
Warnings:
Warning	1287	'<select expression> INTO <destination>;' is deprecated and will be removed in a future release. Please use 'SELECT <select list> INTO <destination> FROM...' instead
set columnstore_use_import_for_batchinsert=ALWAYS;
START TRANSACTION;
INSERT INTO mcol4000(l_comment) VALUES ('mcol4000');
SELECT COUNT(*) FROM mcol4000;
COUNT(*)
1
ROLLBACK;
SELECT COUNT(*) FROM mcol4000;
COUNT(*)
0
START TRANSACTION;
LOAD DATA LOCAL INFILE '/tmp/mcol4000.txt' INTO TABLE mcol4000 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
SELECT COUNT(*) FROM mcol4000;
COUNT(*)
1000000
ROLLBACK;
SELECT COUNT(*) FROM mcol4000;
COUNT(*)
1000000
START TRANSACTION;
LOAD DATA LOCAL INFILE '/tmp/mcol4000.txt' INTO TABLE mcol4000 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
INSERT INTO mcol4000(l_comment) VALUES ('mcol4000');
SELECT COUNT(*) FROM mcol4000;
COUNT(*)
2000001
ROLLBACK;
SELECT COUNT(*) FROM mcol4000;
COUNT(*)
2000000
START TRANSACTION;
INSERT INTO mcol4000(l_comment) VALUES ('mcol4000');
COMMIT;
SELECT COUNT(*) FROM mcol4000;
COUNT(*)
2000001
START TRANSACTION;
LOAD DATA LOCAL INFILE '/tmp/mcol4000.txt' INTO TABLE mcol4000 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
COMMIT;
SELECT COUNT(*) FROM mcol4000;
COUNT(*)
3000001
START TRANSACTION;
LOAD DATA LOCAL INFILE '/tmp/mcol4000.txt' INTO TABLE mcol4000 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
INSERT INTO mcol4000(l_comment) VALUES ('mcol4000');
COMMIT;
SELECT COUNT(*) FROM mcol4000;
COUNT(*)
4000002
INSERT INTO mcol4000(l_comment) VALUES ('mcol4000');
SELECT COUNT(*) FROM mcol4000;
COUNT(*)
4000003
LOAD DATA LOCAL INFILE '/tmp/mcol4000.txt' INTO TABLE mcol4000 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
LOAD DATA LOCAL INFILE '/tmp/mcol4000.txt' INTO TABLE mcol4000 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
SELECT COUNT(*) FROM mcol4000;
COUNT(*)
6000003
INSERT INTO mcol4000(l_comment) VALUES ('mcol4000');
LOAD DATA LOCAL INFILE '/tmp/mcol4000.txt' INTO TABLE mcol4000 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
SELECT COUNT(*) FROM mcol4000;
COUNT(*)
7000004
DROP TABLE mcol4000;
