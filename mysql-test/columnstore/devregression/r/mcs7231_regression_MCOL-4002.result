USE tpch1;
DROP TABLE IF EXISTS mcol4002;
CREATE TABLE mcol4002(
l_orderkey INT,
l_partkey INT,
l_suppkey INT,
l_linenumber BIGINT,
l_quantity DECIMAL(12,2),
l_extendedprice DECIMAL(12,2),
l_discount DECIMAL(12,2),
l_tax DECIMAL(12,2),
l_returnflag CHAR (1),
l_linestatus CHAR (1),
l_shipdate DATE,
l_commitdate DATE,
l_receiptdate DATE,
l_shipinstruct CHAR (25),
l_shipmode CHAR (10),
l_comment VARCHAR (44)
) ENGINE=columnstore;
SELECT * FROM lineitem LIMIT 100 INTO OUTFILE '/tmp/mcol4002.txt' FIELDS TERMINATED BY ',' ENCLOSED BY '"';
Warnings:
Warning	1287	'<select expression> INTO <destination>;' is deprecated and will be removed in a future release. Please use 'SELECT <select list> INTO <destination> FROM...' instead
START TRANSACTION;
INSERT INTO mcol4002(l_comment) VALUES ('mcol4002');
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
1
ROLLBACK;
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
0
START TRANSACTION;
LOAD DATA LOCAL INFILE '/tmp/mcol4002.txt' INTO TABLE mcol4002 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
100
ROLLBACK;
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
0
START TRANSACTION;
INSERT INTO mcol4002(l_comment) VALUES ('mcol4002');
LOAD DATA LOCAL INFILE '/tmp/mcol4002.txt' INTO TABLE mcol4002 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
101
ROLLBACK;
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
0
START TRANSACTION;
LOAD DATA LOCAL INFILE '/tmp/mcol4002.txt' INTO TABLE mcol4002 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
INSERT INTO mcol4002(l_comment) VALUES ('mcol4002');
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
101
ROLLBACK;
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
0
START TRANSACTION;
INSERT INTO mcol4002(l_comment) VALUES ('mcol4002');
LOAD DATA LOCAL INFILE '/tmp/mcol4002.txt' INTO TABLE mcol4002 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
INSERT INTO mcol4002(l_comment) VALUES ('mcol4002');
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
102
ROLLBACK;
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
0
START TRANSACTION;
LOAD DATA LOCAL INFILE '/tmp/mcol4002.txt' INTO TABLE mcol4002 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
INSERT INTO mcol4002(l_comment) VALUES ('mcol4002');
LOAD DATA LOCAL INFILE '/tmp/mcol4002.txt' INTO TABLE mcol4002 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
201
ROLLBACK;
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
0
START TRANSACTION;
INSERT INTO mcol4002(l_comment) VALUES ('mcol4002');
COMMIT;
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
1
START TRANSACTION;
LOAD DATA LOCAL INFILE '/tmp/mcol4002.txt' INTO TABLE mcol4002 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
COMMIT;
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
101
START TRANSACTION;
INSERT INTO mcol4002(l_comment) VALUES ('mcol4002');
LOAD DATA LOCAL INFILE '/tmp/mcol4002.txt' INTO TABLE mcol4002 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
COMMIT;
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
202
START TRANSACTION;
LOAD DATA LOCAL INFILE '/tmp/mcol4002.txt' INTO TABLE mcol4002 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
INSERT INTO mcol4002(l_comment) VALUES ('mcol4002');
COMMIT;
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
303
START TRANSACTION;
INSERT INTO mcol4002(l_comment) VALUES ('mcol4002');
LOAD DATA LOCAL INFILE '/tmp/mcol4002.txt' INTO TABLE mcol4002 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
INSERT INTO mcol4002(l_comment) VALUES ('mcol4002');
COMMIT;
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
405
START TRANSACTION;
LOAD DATA LOCAL INFILE '/tmp/mcol4002.txt' INTO TABLE mcol4002 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
INSERT INTO mcol4002(l_comment) VALUES ('mcol4002');
LOAD DATA LOCAL INFILE '/tmp/mcol4002.txt' INTO TABLE mcol4002 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
COMMIT;
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
606
DELETE FROM mcol4002;
INSERT INTO mcol4002(l_comment) VALUES ('mcol4002');
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
1
LOAD DATA LOCAL INFILE '/tmp/mcol4002.txt' INTO TABLE mcol4002 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
101
INSERT INTO mcol4002(l_comment) VALUES ('mcol4002');
LOAD DATA LOCAL INFILE '/tmp/mcol4002.txt' INTO TABLE mcol4002 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
202
LOAD DATA LOCAL INFILE '/tmp/mcol4002.txt' INTO TABLE mcol4002 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
INSERT INTO mcol4002(l_comment) VALUES ('mcol4002');
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
303
INSERT INTO mcol4002(l_comment) VALUES ('mcol4002');
LOAD DATA LOCAL INFILE '/tmp/mcol4002.txt' INTO TABLE mcol4002 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
INSERT INTO mcol4002(l_comment) VALUES ('mcol4002');
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
405
LOAD DATA LOCAL INFILE '/tmp/mcol4002.txt' INTO TABLE mcol4002 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
INSERT INTO mcol4002(l_comment) VALUES ('mcol4002');
LOAD DATA LOCAL INFILE '/tmp/mcol4002.txt' INTO TABLE mcol4002 FIELDS TERMINATED BY ',' ENCLOSED BY '"';
SELECT COUNT(*) FROM mcol4002;
COUNT(*)
606
DROP TABLE mcol4002;
