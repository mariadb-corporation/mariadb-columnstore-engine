USE ssb1;
select d_year, c_nation,
sum(lo_revenue - lo_supplycost) as profit
from customer, supplier, part,  dateinfo, lineorder	   # changed order
where lo_custkey = c_custkey
and lo_suppkey = s_suppkey
and lo_partkey = p_partkey
and lo_orderdate = d_datekey
and c_region = 'AMERICA'
and s_region = 'AMERICA'
and (p_mfgr = 'MFGR#1'
or p_mfgr = 'MFGR#2')
group by d_year, c_nation
order by d_year, c_nation;
d_year	c_nation	profit
1992	ARGENTINA	10306618815.00
1992	BRAZIL	9936202012.00
1992	CANADA	10656604821.00
1992	PERU	10284462699.00
1992	UNITED STATES	10764674516.00
1993	ARGENTINA	10549137980.00
1993	BRAZIL	9917026120.00
1993	CANADA	10230096109.00
1993	PERU	10214245521.00
1993	UNITED STATES	11086060245.00
1994	ARGENTINA	10606326947.00
1994	BRAZIL	9570130225.00
1994	CANADA	10972788937.00
1994	PERU	10461046494.00
1994	UNITED STATES	10583062806.00
1995	ARGENTINA	10935485307.00
1995	BRAZIL	9941968003.00
1995	CANADA	10463355474.00
1995	PERU	9942788616.00
1995	UNITED STATES	10178551443.00
1996	ARGENTINA	11008724005.00
1996	BRAZIL	10050156134.00
1996	CANADA	10610188583.00
1996	PERU	10237167163.00
1996	UNITED STATES	10827788115.00
1997	ARGENTINA	10682859076.00
1997	BRAZIL	10009823271.00
1997	CANADA	10971120327.00
1997	PERU	10187664432.00
1997	UNITED STATES	10923553800.00
1998	ARGENTINA	6582110165.00
1998	BRAZIL	6057679775.00
1998	CANADA	6347062583.00
1998	PERU	6017567732.00
1998	UNITED STATES	6440042604.00
