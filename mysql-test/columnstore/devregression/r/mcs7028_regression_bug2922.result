USE ssb1;
select   c_name, d_month, sum(lo_extendedprice), min(lo_orderdate), max(lo_orderdate)  from     lineorder join customer on lo_custkey = c_custkey                              join dateinfo on lo_orderdate = d_datekey           where lo_orderdate between  19970101 and 19971230           and lo_custkey in ( select lo_custkey from                                                   (select lo_custkey, sum(lo_extendedprice)                                                               from lineorder                                                               where lo_orderdate between 19971201 and 19971230                                                                    group by 1 order by 2 desc limit 10 ) a   )   group by 1,2 order by 1,2;
c_name	d_month	sum(lo_extendedprice)	min(lo_orderdate)	max(lo_orderdate)
Customer#000004069	April	21125678.00	19970419	19970419
Customer#000004069	Augest	20575825.00	19970827	19970827
Customer#000004069	December	113152144.00	19971204	19971218
Customer#000004069	February	8978034.00	19970221	19970221
Customer#000004069	January	11268406.00	19970111	19970125
Customer#000004069	July	7124434.00	19970716	19970716
Customer#000004069	June	19457631.00	19970612	19970612
Customer#000004069	March	9009729.00	19970303	19970303
Customer#000004069	May	70678616.00	19970509	19970519
Customer#000004069	November	38789361.00	19971105	19971113
Customer#000004069	Octorber	29258802.00	19971016	19971027
Customer#000004069	September	14125002.00	19970904	19970916
Customer#000005044	April	11564240.00	19970414	19970422
Customer#000005044	Augest	45510875.00	19970811	19970820
Customer#000005044	December	125177116.00	19971213	19971224
Customer#000005044	February	6175292.00	19970226	19970226
Customer#000005044	January	3621912.00	19970119	19970119
Customer#000005044	July	38067273.00	19970702	19970728
Customer#000005044	June	23521471.00	19970602	19970620
Customer#000005044	May	64822910.00	19970513	19970530
Customer#000005044	November	26601914.00	19971123	19971124
Customer#000005044	Octorber	22654964.00	19971014	19971031
Customer#000005044	September	40649108.00	19970923	19970923
Customer#000007603	April	44936847.00	19970410	19970422
Customer#000007603	December	140826821.00	19971203	19971229
Customer#000007603	February	6756338.00	19970224	19970224
Customer#000007603	January	13228025.00	19970102	19970102
Customer#000007603	July	26643005.00	19970705	19970721
Customer#000007603	June	24788678.00	19970619	19970624
Customer#000007603	March	14743022.00	19970330	19970330
Customer#000007603	May	7965026.00	19970529	19970529
Customer#000007603	Octorber	18343528.00	19971024	19971024
Customer#000007603	September	4957153.00	19970905	19970923
Customer#000010774	Augest	24107364.00	19970805	19970816
Customer#000010774	December	122948511.00	19971204	19971211
Customer#000010774	February	30707702.00	19970215	19970222
Customer#000010774	January	5452488.00	19970113	19970113
Customer#000010774	July	5722713.00	19970716	19970716
Customer#000010774	June	55198666.00	19970606	19970614
Customer#000010774	March	71491559.00	19970311	19970328
Customer#000010774	November	69058986.00	19971109	19971126
Customer#000010774	Octorber	41452044.00	19971020	19971026
Customer#000010774	September	25036440.00	19970930	19970930
Customer#000011731	April	21010770.00	19970405	19970405
Customer#000011731	Augest	45281533.00	19970809	19970830
Customer#000011731	December	139417016.00	19971205	19971220
Customer#000011731	February	22985450.00	19970207	19970211
Customer#000011731	January	50528512.00	19970117	19970131
Customer#000011731	July	10747859.00	19970709	19970709
Customer#000011731	June	6292314.00	19970616	19970616
Customer#000011731	March	20465224.00	19970305	19970305
Customer#000011731	September	8316196.00	19970902	19970908
Customer#000013396	April	18029353.00	19970412	19970425
Customer#000013396	December	116662602.00	19971205	19971228
Customer#000013396	February	25785304.00	19970225	19970225
Customer#000013396	January	17883861.00	19970121	19970127
Customer#000013396	July	20154854.00	19970704	19970704
Customer#000013396	May	30013896.00	19970501	19970521
Customer#000013396	Octorber	62557053.00	19971009	19971031
Customer#000013396	September	24508449.00	19970906	19970906
Customer#000015715	April	16488864.00	19970414	19970414
Customer#000015715	December	130063207.00	19971201	19971225
Customer#000015715	July	3843624.00	19970720	19970720
Customer#000015715	June	32091988.00	19970618	19970624
Customer#000015715	March	19359787.00	19970308	19970308
Customer#000015715	May	52332370.00	19970512	19970526
Customer#000015715	November	45275020.00	19971115	19971130
Customer#000015715	September	44116849.00	19970906	19970929
Customer#000018211	April	35495129.00	19970425	19970425
Customer#000018211	December	114244135.00	19971210	19971228
Customer#000018211	February	15447237.00	19970220	19970220
Customer#000018211	July	23683773.00	19970727	19970727
Customer#000018211	June	978426.00	19970606	19970606
Customer#000018211	March	1171624.00	19970319	19970319
Customer#000018211	May	32311651.00	19970506	19970518
Customer#000018211	September	264848.00	19970927	19970927
Customer#000019123	April	9166502.00	19970420	19970420
Customer#000019123	December	119723270.00	19971201	19971230
Customer#000019123	February	32932048.00	19970212	19970214
Customer#000019123	January	34771024.00	19970121	19970126
Customer#000019123	July	35836420.00	19970705	19970720
Customer#000019123	March	55962971.00	19970311	19970314
Customer#000019123	May	19076319.00	19970518	19970524
Customer#000019123	November	30034974.00	19971112	19971112
Customer#000019123	Octorber	33170059.00	19971013	19971013
Customer#000019123	September	18950129.00	19970910	19970919
Customer#000028558	April	20820127.00	19970405	19970411
Customer#000028558	Augest	4305224.00	19970815	19970815
Customer#000028558	December	113138659.00	19971208	19971228
Customer#000028558	March	33782060.00	19970330	19970330
Customer#000028558	November	3686042.00	19971126	19971126
Customer#000028558	Octorber	34536253.00	19971011	19971011
Customer#000028558	September	26372157.00	19970907	19970909
select   count(*)  from     lineorder             where lo_orderdate between  19970101 and 19970105           and lo_custkey not in  ( select lo_custkey                from  (select lo_custkey from lineorder                        where lo_orderdate between 19971201 and 19971201                       ) a                                );
count(*)
11926
