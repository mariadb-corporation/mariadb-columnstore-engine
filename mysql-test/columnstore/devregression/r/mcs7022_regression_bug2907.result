USE ssb1;
select   lo_shipmode, c_region,  sum(lo_extendedprice), count(*) from     lineorder join customer on lo_custkey = c_custkey  where lo_orderdate between (select d_start  from ( select d_yearmonthnum * 100 + 1 d_start  , count(*) from dateinfo where d_weekdayfl = 1 and d_year = 1998 group by 1 order by 2 desc limit 1) alias1) and (select d_end  from ( select d_yearmonthnum * 100 + 31 d_end  , count(*) from dateinfo where d_weekdayfl = 1 and d_year = 1998 group by 1 order by 2 desc limit 1) alias2) group by 1,2 order by 1,2;
lo_shipmode	c_region	sum(lo_extendedprice)	count(*)
AIR	AFRICA	8291782410.00	2170
AIR	AMERICA	8436416712.00	2214
AIR	ASIA	8586449147.00	2237
AIR	EUROPE	8453917173.00	2198
AIR	MIDDLE EAST	8374048202.00	2175
FOB	AFRICA	8222451296.00	2151
FOB	AMERICA	8795070316.00	2262
FOB	ASIA	8721414039.00	2259
FOB	EUROPE	8581506525.00	2249
FOB	MIDDLE EAST	8975397130.00	2318
MAIL	AFRICA	8318241157.00	2199
MAIL	AMERICA	8230593182.00	2103
MAIL	ASIA	8754808681.00	2267
MAIL	EUROPE	8051255917.00	2116
MAIL	MIDDLE EAST	8604590488.00	2242
RAIL	AFRICA	8959535402.00	2319
RAIL	AMERICA	8654124417.00	2264
RAIL	ASIA	8792793574.00	2282
RAIL	EUROPE	8186982361.00	2189
RAIL	MIDDLE EAST	8149675405.00	2145
REG AIR	AFRICA	8199132520.00	2141
REG AIR	AMERICA	8351964483.00	2176
REG AIR	ASIA	8541147824.00	2291
REG AIR	EUROPE	8603274423.00	2302
REG AIR	MIDDLE EAST	8016893567.00	2122
SHIP	AFRICA	8412953175.00	2253
SHIP	AMERICA	8208649535.00	2160
SHIP	ASIA	8746116053.00	2253
SHIP	EUROPE	8483100040.00	2242
SHIP	MIDDLE EAST	8687217441.00	2256
TRUCK	AFRICA	8613962857.00	2253
TRUCK	AMERICA	8635423089.00	2203
TRUCK	ASIA	8204740240.00	2127
TRUCK	EUROPE	8281322322.00	2198
TRUCK	MIDDLE EAST	8502459194.00	2252
